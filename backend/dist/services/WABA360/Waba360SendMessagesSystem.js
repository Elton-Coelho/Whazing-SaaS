'use strict';
const C = b, D = b;
(function (c, d) {
    const A = b, B = b, e = c();
    while (!![]) {
        try {
            const f = parseInt(A(0xef)) / (0x1a7a + 0x9f9 * 0x1 + -0x2472) * (-parseInt(B(0x12f)) / (0x1efb + 0x1e95 * 0x1 + -0x1 * 0x3d8e)) + parseInt(B(0x130)) / (-0x1 * 0x228a + -0x1 * 0x84e + -0x35 * -0xcf) * (parseInt(B(0x114)) / (-0x2103 + -0x10c7 + 0x31ce)) + parseInt(A(0x150)) / (-0x1c * -0x163 + 0x225 + -0x1 * 0x28f4) * (-parseInt(B(0xe8)) / (0xd * -0xa2 + -0x243 + 0xa83)) + parseInt(B(0x15d)) / (0x3a * -0x5b + 0x2587 + -0x10e2) * (parseInt(A(0xf0)) / (-0x5df + -0x1 * 0xd35 + 0x131c)) + -parseInt(A(0x15e)) / (0x2558 + -0xb7e + -0x19d1) * (parseInt(B(0xfc)) / (-0x86a + -0x5 * 0x40f + 0x1cbf * 0x1)) + -parseInt(B(0x13e)) / (-0xc6a * -0x2 + 0x141c * -0x1 + -0x85 * 0x9) + parseInt(B(0x14d)) / (-0x32 * 0xbc + 0x1 * 0x272 + 0x2252);
            if (f === d)
                break;
            else
                e['push'](e['shift']());
        } catch (g) {
            e['push'](e['shift']());
        }
    }
}(a, 0x15e9e8 + -0x1306e5 + 0x110a * 0x8d));
function b(c, d) {
    const e = a();
    return b = function (f, g) {
        f = f - (-0x875 * -0x4 + 0x6ba + -0x27b3);
        let h = e[f];
        return h;
    }, b(c, d);
}
var __importDefault = this && this[C(0xed) + C(0x12e)] || function (c) {
    const E = D;
    return c && c[E(0x12c)] ? c : { 'default': c };
};
function a() {
    const J = [
        '23284YORMsk',
        'dataValues',
        'NLnQO',
        'timestamp',
        'logger',
        'SoaDL',
        'ers/SetTic',
        'tenantId',
        'Lnwxs',
        'lte',
        'LOwTh',
        'number',
        'RPSKZ',
        'findAll',
        'text',
        'ikBJx',
        'gATEi',
        'mediaType',
        'apiKey',
        'ls/Ticket',
        'age',
        'ers/socket',
        'AJwrK',
        'VfrKG',
        '__esModule',
        'PuMBz',
        'fault',
        '26AQwRWP',
        '597EvMaUW',
        'chat',
        '../../mode',
        'message',
        'GGjKV',
        'image',
        'createdAt',
        'vjPDt',
        'sdkUC',
        'sAsRead',
        'type',
        'OyeFF',
        'individual',
        'pending',
        '7193285zxhPbt',
        'euXlL',
        'includes',
        'siISo',
        'bUFjf',
        'default',
        'where',
        'update',
        'twQmd',
        '../../help',
        './SentMess',
        'Emit',
        'jeaNq',
        'vWzVR',
        'defineProp',
        '32954388WhOhMR',
        'contact',
        'mediaUrl',
        '2735450fSGgpV',
        'NqlWW',
        'sequelize',
        'ASC',
        'gCYby',
        'messageId',
        'pqmEm',
        'sended',
        'ack',
        'zRZWE',
        'hqeFp',
        's/logger',
        'voice',
        '7bmRaWK',
        '1224OkOPRo',
        'QvDQE',
        'YDiAf',
        'IKpTQ',
        '360',
        'qSbyN',
        'mkXVl',
        'YYFUr',
        'document',
        'wabaMediaI',
        'info',
        'DMuIq',
        'whatsapp',
        'IFuXJ',
        '12uxHgbl',
        'OIrvQ',
        'WYPSI',
        'audio',
        'body',
        '__importDe',
        '../../util',
        '34732sJWenw',
        '68624QdOECk',
        'erty',
        'kTznP',
        'VQtQU',
        'xNnnR',
        'aRezg',
        'messages',
        'ls/Whatsap',
        'ls/Message',
        'xnXOB',
        'ketMessage',
        'tokenAPI',
        '66860mdcTjK',
        'Message\x20Up',
        'jRkCE',
        'value',
        'Btcue',
        'mediaName',
        'lqqbl',
        'quotedMsg',
        'WWSJd',
        'date\x20ok',
        'applicatio',
        'tWaFR',
        'video',
        'ticket',
        'zbfoN',
        'AQNVC',
        'KnISY',
        'waba',
        'chat:ack',
        'status',
        'payload',
        'caption',
        'MnanY',
        'csumf'
    ];
    a = function () {
        return J;
    };
    return a();
}
const m = {};
m[C(0xff)] = !![], Object[C(0x14c) + C(0xf1)](exports, D(0x12c), m);
const sequelize_1 = require(D(0x152)), SetTicketMessagesAsRead_1 = __importDefault(require(D(0x147) + C(0x11a) + D(0xfa) + D(0x139))), socketEmit_1 = __importDefault(require(D(0x147) + C(0x129) + C(0x149))), Message_1 = __importDefault(require(D(0x132) + C(0xf8))), Ticket_1 = __importDefault(require(D(0x132) + C(0x127))), Whatsapp_1 = __importDefault(require(C(0x132) + D(0xf7) + 'p')), logger_1 = require(C(0xee) + D(0x15b)), SentMessage_1 = __importDefault(require(D(0x148) + C(0x128))), buildWabaMessage360 = async (h, i) => {
        const F = C, G = D, j = {
                'NLnQO': F(0x135),
                'AJwrK': F(0x108),
                'KnISY': F(0xeb),
                'Btcue': function (l, o) {
                    return l(o);
                },
                'VQtQU': G(0x13c),
                'VfrKG': F(0x122),
                'pqmEm': function (l, o) {
                    return l === o;
                },
                'OyeFF': G(0x106) + 'n',
                'LOwTh': G(0xe2),
                'vjPDt': G(0x142),
                'sdkUC': G(0x107),
                'QvDQE': function (l, o) {
                    return l === o;
                },
                'GGjKV': function (l, o) {
                    return l !== o;
                },
                'hqeFp': G(0xf4),
                'WYPSI': function (l, o) {
                    return l === o;
                },
                'DMuIq': F(0xdf),
                'YYFUr': G(0x15c),
                'ikBJx': G(0x151),
                'RPSKZ': G(0xfe),
                'IFuXJ': function (l, o) {
                    return l === o;
                },
                'zRZWE': F(0x131),
                'euXlL': function (l, o) {
                    return l === o;
                },
                'Lnwxs': function (l, o) {
                    return l !== o;
                },
                'IKpTQ': G(0xf2)
            };
        let k = {
            'timestamp': j[G(0x100)](String, h[G(0x117)]),
            'recipient_type': j[G(0xf3)],
            'to': i,
            'type': j[F(0x12b)]
        };
        if (j[G(0x156)](h[F(0x125)], j[G(0x13b)]) || j[F(0x156)](h[F(0x125)], j[G(0x11e)])) {
            if (j[G(0x156)](j[F(0x137)], j[F(0x138)])) {
                const o = {};
                return o[G(0x143)] = j, g && h[G(0x12c)] ? i : o;
            } else {
                const o = {};
                o['id'] = h[F(0xe3) + 'd'], o[F(0x111)] = h[G(0xec)] || h[F(0x101)] || '' || '', k = {
                    ...k,
                    'type': j[G(0x11e)],
                    'document': o
                };
            }
        }
        if (j[F(0xdb)](h[F(0x125)], j[G(0x116)])) {
            if (j[G(0x134)](j[G(0x15a)], j[G(0x15a)])) {
                const q = {};
                q['id'] = j[G(0xe3) + 'd'], q[F(0x111)] = k[F(0xec)] || l[G(0x101)] || '';
                const r = { ...i };
                r[F(0x13a)] = j[G(0x116)], r[F(0x135)] = q, h = r;
            } else {
                const q = {};
                q['id'] = h[F(0xe3) + 'd'], q[F(0x111)] = h[G(0xec)] || h[F(0x101)] || '', k = {
                    ...k,
                    'type': j[F(0x116)],
                    'image': q
                };
            }
        }
        if (j[G(0xea)](h[F(0x125)], j[F(0x12a)])) {
            if (j[F(0xdb)](j[G(0xe5)], j[G(0xe5)])) {
                const r = {};
                r['id'] = h[G(0xe3) + 'd'], r[F(0x111)] = h[F(0xec)] || h[G(0x101)] || '', k = {
                    ...k,
                    'type': j[G(0x12a)],
                    'video': r
                };
            } else {
                const t = {};
                t['id'] = j[F(0xe3) + 'd'], t[F(0x111)] = k[F(0xec)] || l[G(0x101)] || '';
                const u = { ...i };
                u[F(0x13a)] = j[G(0x12a)], u[F(0x108)] = t, h = u;
            }
        }
        if (j[G(0xdb)](h[F(0x125)], j[G(0x10c)]) || j[F(0xea)](h[G(0x125)], j[G(0xe1)])) {
            if (j[G(0xdb)](j[G(0x123)], j[F(0x120)])) {
                const u = {};
                u['id'] = j[G(0xe3) + 'd'], u[G(0x111)] = k[F(0xec)] || l[G(0x101)] || '';
                const v = { ...i };
                v[G(0x13a)] = j[F(0x10c)], v[F(0xeb)] = u, h = v;
            } else {
                const u = {};
                u['id'] = h[F(0xe3) + 'd'], u[F(0x111)] = h[G(0xec)] || h[G(0x101)] || '', k = {
                    ...k,
                    'type': j[F(0x10c)],
                    'audio': u
                };
            }
        }
        if (j[F(0xe7)](h[F(0x125)], j[G(0x159)]) || j[F(0x13f)](h[F(0x125)], j[F(0x12b)])) {
            if (j[G(0x11c)](j[F(0xdd)], j[F(0xdd)])) {
                const w = {};
                w[F(0xec)] = x[F(0xec)];
                const x = { ...w };
                x[G(0x122)] = w, f = x;
            } else {
                const w = {};
                w[G(0xec)] = h[G(0xec)], k = {
                    ...k,
                    'text': w
                };
            }
        }
        return k;
    }, n = { [sequelize_1['Op']['is']]: null }, where = {
        'fromMe': !![],
        'messageId': n,
        'status': D(0x13d),
        [sequelize_1['Op']['or']]: [
            { 'scheduleDate': { [sequelize_1['Op'][C(0x11d)]]: new Date() } },
            { 'scheduleDate': { [sequelize_1['Op']['is']]: null } }
        ]
    }, Waba360SendMessagesSystem = async i => {
        const H = C, I = C, j = {
                'twQmd': H(0xe2),
                'lqqbl': H(0x14e),
                'jeaNq': H(0x109),
                'MnanY': I(0x10d),
                'siISo': H(0xe6),
                'aRezg': H(0xde),
                'YDiAf': H(0x103),
                'AQNVC': I(0x136),
                'SoaDL': I(0x153),
                'xnXOB': function (l, o) {
                    return l !== o;
                },
                'gCYby': I(0x124),
                'OIrvQ': function (l, o) {
                    return l(o);
                },
                'csumf': I(0x122),
                'vWzVR': I(0x131),
                'zbfoN': function (l, o, p) {
                    return l(o, p);
                },
                'WWSJd': H(0x157),
                'PuMBz': H(0x10e),
                'mkXVl': H(0xfd) + H(0x105)
            }, k = await Message_1[H(0x143)][I(0x121)]({
                'where': where,
                'include': [
                    j[H(0x102)],
                    {
                        'model': Ticket_1[H(0x143)],
                        'as': j[H(0x14a)],
                        'where': {
                            'tenantId': i[I(0x11b)],
                            'channel': j[I(0x112)]
                        },
                        'include': [
                            j[H(0x102)],
                            {
                                'model': Whatsapp_1[I(0x143)],
                                'as': j[I(0x141)],
                                'where': {
                                    'id': i['id'],
                                    'type': j[H(0x112)],
                                    'wabaBSP': j[I(0xf5)]
                                }
                            }
                        ]
                    },
                    {
                        'model': Message_1[I(0x143)],
                        'as': j[H(0xdc)],
                        'include': [j[I(0x102)]]
                    }
                ],
                'order': [[
                        j[I(0x10b)],
                        j[H(0x119)]
                    ]]
            });
        for (const l of k) {
            if (j[H(0xf9)](j[H(0x154)], j[I(0x154)])) {
                const p = {};
                p['id'] = j[H(0xe3) + 'd'], p[H(0x111)] = k[I(0xec)] || l[I(0x101)] || '' || '';
                const q = { ...i };
                q[I(0x13a)] = j[I(0x146)], q[H(0xe2)] = p, h = q;
            } else {
                const {ticket: p} = l, q = j[I(0xe9)](String, p[H(0x14e)][I(0x11f)]);
                if (![
                        j[H(0x113)],
                        j[H(0x14b)]
                    ][I(0x140)](l[H(0x125)]) && l[H(0x14f)] && !l[H(0xe3) + 'd']) {
                }
                const r = await j[H(0x10a)](buildWabaMessage360, l, q), s = {};
                s[I(0x133)] = r, s[H(0x126)] = i[I(0xfb)];
                const t = await (0x1547 * -0x1 + 0x1960 + -0x419, SentMessage_1[I(0x143)])(s), u = { ...l };
                u[I(0x155)] = t[I(0xf6)][0x1 * 0x247a + 0x2395 + -0x480f]['id'], u[I(0x10f)] = j[H(0x104)], u[I(0x158)] = 0x2;
                const v = u, w = { ...v }, x = {};
                x['id'] = l['id'];
                const y = {};
                y[I(0x144)] = x, await Message_1[H(0x143)][I(0x145)](w, y);
                const z = {};
                z[H(0x11b)] = p[I(0x11b)], z[I(0x13a)] = j[I(0x12d)], z[I(0x110)] = { ...v[H(0x115)] }, z[I(0x110)][I(0x14f)] = l[H(0x14f)], z[I(0x110)][H(0x155)] = v[H(0x155)], z[I(0x110)][H(0x10f)] = j[I(0x104)], z[I(0x110)][I(0x158)] = 0x2, (-0xc7 + 0x2 * 0x355 + 0x1 * -0x5e3, socketEmit_1[H(0x143)])(z), logger_1[H(0x118)][I(0xe4)](j[H(0xe0)]), await (-0x2018 + 0xa63 * -0x2 + -0x1a6f * -0x2, SetTicketMessagesAsRead_1[I(0x143)])(p);
            }
        }
    };
exports[D(0x143)] = Waba360SendMessagesSystem;