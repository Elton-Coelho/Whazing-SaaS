'use strict';
const B = b, C = b;
(function (c, d) {
    const z = b, A = b, e = c();
    while (!![]) {
        try {
            const f = parseInt(z(0x225)) / (-0x185d + -0x1e52 + 0x36b0) + parseInt(z(0x213)) / (0x18a7 + -0xc * 0x83 + 0x1281 * -0x1) * (parseInt(A(0x1e5)) / (0x115 * -0x5 + 0x1541 + -0x3 * 0x547)) + -parseInt(z(0x23f)) / (-0xed4 + 0x3 * -0xb69 + 0x2e3 * 0x11) * (-parseInt(z(0x1fd)) / (0xe8 * -0x27 + -0x1b49 + 0x129 * 0x36)) + -parseInt(A(0x22c)) / (0x1 * -0xaf3 + -0x2573 + 0x306c) * (-parseInt(z(0x226)) / (0x71c + -0x43 * 0x53 + 0xea4)) + -parseInt(z(0x1f5)) / (0x16bd + 0x2 * 0x12c1 + -0x3c37) + parseInt(A(0x1e2)) / (0x1 * 0x247f + 0x241c + -0x4892) + -parseInt(z(0x1dc)) / (0x10e6 + -0x3b9 + -0xd23);
            if (f === d)
                break;
            else
                e['push'](e['shift']());
        } catch (g) {
            e['push'](e['shift']());
        }
    }
}(a, 0x92283 + -0x3bdf * -0x27 + -0x428d8));
var __importDefault = this && this[B(0x204) + C(0x21a)] || function (c) {
    const D = B;
    return c && c[D(0x22a)] ? c : { 'default': c };
};
const u = {};
function b(c, d) {
    const e = a();
    return b = function (f, g) {
        f = f - (0x7 * 0x4d5 + 0x2 * 0x29 + -0x204c);
        let h = e[f];
        return h;
    }, b(c, d);
}
function a() {
    const O = [
        'BGVfX',
        'uIJAK',
        'headers',
        '229025ZUjHrx',
        '512827vUqAOi',
        'gJALp',
        'MWVdP',
        'VcRNx',
        '__esModule',
        'Kjlwf',
        '6euIjfc',
        'AIAri',
        'image',
        'MSbXk',
        'data',
        'hSnOx',
        'eStream',
        'public',
        'WXNSs',
        'url',
        'audio',
        'skerg',
        '../../util',
        'stream',
        'kIVXm',
        'kWvPD',
        'voice',
        'ogUQh',
        'ZGMCV',
        '395180pwDxaw',
        'NxqLu',
        'XaOCs',
        'mime_type',
        'xyMNU',
        '../../erro',
        'Croow',
        '11123130wVWiNa',
        'responseTy',
        'fEKAt',
        'OiWTH',
        'geiIE',
        'length',
        '2158461bionai',
        'IA:\x20',
        'dTluU',
        '972117XAKxFy',
        'OHhht',
        'join',
        'qepgU',
        'logger',
        'getTime',
        'axios',
        'filename',
        'XXmjw',
        'GET',
        'dQOWU',
        'finish',
        'RHCBd',
        'value',
        'AAOXC',
        'LVPRY',
        '4518816MkOIrS',
        'tokenAPI',
        's/logger',
        'rs/AppErro',
        'idlkD',
        'split',
        'method',
        'nwYVB',
        '55sAkmxQ',
        'VCRja',
        'lBmiK',
        'RLRwY',
        'XnAjv',
        'erty',
        'pKRNk',
        '__importDe',
        'pipe',
        'defineProp',
        'DMlNG',
        'env',
        'API_URL_36',
        'document',
        'WNLOAD_MED',
        'createWrit',
        'DKrmS',
        'error',
        'gNcaH',
        'hZfZr',
        'path',
        'D360-API-K',
        '6BAacje',
        'VBijN',
        'KliwI',
        'default',
        'ERROR\x20DONW',
        'nktGi',
        'jmhZU',
        'fault',
        'IJoDl',
        '360_NOT_DO',
        'fBTku',
        'LOAD',
        'ZplBQ',
        '/v1/media/',
        'video'
    ];
    a = function () {
        return O;
    };
    return a();
}
u[B(0x1f2)] = !![], Object[B(0x206) + B(0x202)](exports, C(0x22a), u);
const axios_1 = __importDefault(require(B(0x1eb))), fs_1 = require('fs'), path_1 = require(C(0x211)), AppError_1 = __importDefault(require(B(0x1da) + B(0x1f8) + 'r')), logger_1 = require(B(0x238) + C(0x1f7)), downloadFile = async (e, f, g) => {
        const E = C, F = B, h = {
                'DKrmS': function (n, o) {
                    return n === o;
                },
                'skerg': E(0x21f),
                'IJoDl': E(0x217) + E(0x21e),
                'XaOCs': function (n, o) {
                    return n(o);
                },
                'MSbXk': function (n, o) {
                    return n !== o;
                },
                'BGVfX': E(0x22b),
                'KliwI': F(0x20f),
                'gJALp': E(0x1f0),
                'dQOWU': F(0x20e),
                'uIJAK': F(0x233),
                'lBmiK': E(0x1ee),
                'Croow': E(0x239)
            }, i = process[E(0x208)][E(0x209) + '0'] + F(0x220) + f, j = (0x24af + 0x1 * 0xf61 + 0x1a08 * -0x2, path_1[F(0x1e7)])(__dirname, '..', '..', h[F(0x223)], g), k = {};
        k[E(0x212) + 'EY'] = e;
        const l = {};
        l[E(0x235)] = i, l[F(0x1fb)] = h[E(0x1ff)], l[E(0x1dd) + 'pe'] = h[F(0x1db)], l[F(0x224)] = k;
        const m = await (-0x1993 * 0x1 + -0x9 * 0x319 + 0x3574, axios_1[E(0x216)])(l);
        await new Promise((n, o) => {
            const G = F, H = F;
            h[G(0x22f)](h[H(0x222)], h[G(0x215)]) ? m[G(0x230)][G(0x205)]((-0x396 + -0x6dc * 0x4 + -0x2 * -0xf83, fs_1[G(0x20c) + H(0x232)])(j))['on'](h[G(0x227)], async () => n(!![]))['on'](h[H(0x1ef)], p => {
                const I = H, J = G;
                h[I(0x20d)](h[J(0x237)], h[I(0x237)]) ? (console[I(0x20e)](h[J(0x21b)], p), h[I(0x241)](o, new Error(p))) : (g = h[I(0x22e)]['id'] || '', i = j[I(0x22e)][J(0x242)]);
            }) : (g = h[H(0x221)]['id'] || '', i = j[G(0x221)][G(0x242)]);
        });
    }, GetMediaWaba360 = async ({
        channel: c,
        msg: d,
        ticket: e
    }) => {
        const K = B, L = B, f = {
                'MWVdP': K(0x217) + K(0x21e),
                'fBTku': function (g, h) {
                    return g(h);
                },
                'AAOXC': K(0x1f0),
                'WXNSs': L(0x20e),
                'hSnOx': function (g, h) {
                    return g > h;
                },
                'nwYVB': function (g, h) {
                    return g !== h;
                },
                'OiWTH': L(0x1e4),
                'NxqLu': K(0x1e0),
                'kIVXm': function (g, h) {
                    return g !== h;
                },
                'DMlNG': K(0x219),
                'RLRwY': L(0x201),
                'ogUQh': function (g, h) {
                    return g === h;
                },
                'OHhht': L(0x23e),
                'nktGi': L(0x1fe),
                'LVPRY': L(0x1d9),
                'pKRNk': function (g, h) {
                    return g !== h;
                },
                'qepgU': L(0x214),
                'XXmjw': K(0x1de),
                'VcRNx': function (g, h) {
                    return g === h;
                },
                'AIAri': K(0x1f1),
                'kWvPD': function (g, h, i, j) {
                    return g(h, i, j);
                },
                'hZfZr': L(0x1f9)
            };
        try {
            if (f[K(0x1fc)](f[K(0x1df)], f[L(0x240)])) {
                let g = '', h, i;
                if (d?.[L(0x20a)]) {
                    if (f[K(0x23a)](f[K(0x207)], f[L(0x200)]))
                        g = d[K(0x20a)]['id'] || '', h = d[L(0x20a)][K(0x1ec)], i = d[L(0x20a)][K(0x242)];
                    else {
                        g[L(0x1e9)][K(0x20e)](h);
                        throw new i[(K(0x216))](L(0x21c) + K(0x20b) + K(0x1e3) + j);
                    }
                }
                d?.[L(0x22e)] && (f[K(0x23d)](f[L(0x1e6)], f[K(0x1e6)]) ? (g = d[K(0x22e)]['id'] || '', i = d[K(0x22e)][K(0x242)]) : j[K(0x230)][K(0x205)]((-0x7be + -0x2b7 + 0xa75, k[K(0x20c) + L(0x232)])(l))['on'](f[L(0x1f3)], async () => q(!![]))['on'](f[L(0x234)], v => {
                    const M = K, N = L;
                    q[M(0x20e)](f[N(0x228)], v), f[N(0x21d)](r, new s(v));
                }));
                d?.[L(0x221)] && (f[L(0x23d)](f[L(0x218)], f[K(0x1f4)]) ? (h[L(0x20e)](f[L(0x228)], i), f[L(0x21d)](j, new k(l))) : (g = d[L(0x221)]['id'] || '', i = d[K(0x221)][K(0x242)]));
                if (d?.[K(0x23c)]) {
                    if (f[L(0x203)](f[L(0x1e8)], f[K(0x1ed)])) {
                        g = d[K(0x23c)]['id'] || '';
                        const p = d[L(0x23c)][K(0x242)] || '', q = p[K(0x1fa)](';');
                        i = f[K(0x231)](q[K(0x1e1)], 0x7ac * -0x5 + 0x26ef * -0x1 + 0x61 * 0xcc) ? q[-0x8 * -0x118 + 0x511 + -0x49b * 0x3] : d[L(0x23c)][L(0x242)];
                    } else
                        g = h[K(0x236)]['id'] || '', i = j[K(0x236)][K(0x242)];
                }
                if (d?.[K(0x236)]) {
                    if (f[L(0x229)](f[K(0x22d)], f[L(0x22d)]))
                        g = d[L(0x236)]['id'] || '', i = d[L(0x236)][K(0x242)];
                    else {
                        const t = {};
                        return t[K(0x216)] = j, g && h[L(0x22a)] ? i : t;
                    }
                }
                const j = i?.[L(0x1fa)]('/')[0x2696 * -0x1 + 0x15e2 + 0x10b5][L(0x1fa)](';')[0xe8d + -0x601 + -0x4 * 0x223], k = new Date()[L(0x1ea)](), l = h ? h + '_' + e['id'] + '_' + g + '_' + k + '.' + j : e['id'] + '_' + g + '_' + k + '.' + j;
                return await f[K(0x23b)](downloadFile, c[K(0x1f6)], g, l), l;
            } else
                i = j[K(0x20a)]['id'] || '', k = l[L(0x20a)][L(0x1ec)], m = n[K(0x20a)][L(0x242)];
        } catch (v) {
            if (f[K(0x23d)](f[L(0x210)], f[K(0x210)])) {
                logger_1[K(0x1e9)][L(0x20e)](v);
                throw new AppError_1[(L(0x216))](K(0x21c) + L(0x20b) + L(0x1e3) + v);
            } else {
                h = i[L(0x23c)]['id'] || '';
                const x = j[L(0x23c)][L(0x242)] || '', y = x[K(0x1fa)](';');
                k = f[K(0x231)](y[L(0x1e1)], -0x2b * 0x8b + 0xb71 * 0x1 + 0x1 * 0xbe9) ? y[0x2471 + 0x232b + -0x479c] : l[L(0x23c)][K(0x242)];
            }
        }
    };
exports[B(0x216)] = GetMediaWaba360;