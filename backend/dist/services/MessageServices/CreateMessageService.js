'use strict';
const a4 = b, a5 = b;
(function (c, d) {
    const a2 = b, a3 = b, e = c();
    while (!![]) {
        try {
            const f = parseInt(a2(0x1cb)) / (0x22 * -0x9d + 0x241 + 0x129a) * (parseInt(a2(0x1a0)) / (0x1 * -0x1cdf + 0x15fb + 0x1 * 0x6e6)) + parseInt(a3(0x17e)) / (-0x1862 * 0x1 + -0x1ecc + 0x3731) * (parseInt(a3(0x18b)) / (-0x17f9 * -0x1 + -0x2510 + 0xd1b)) + -parseInt(a2(0x1c6)) / (-0x27 * -0xe5 + 0x1ead * -0x1 + -0x431) * (-parseInt(a3(0x1ad)) / (0x6f4 * 0x2 + -0x385 + -0xa5d * 0x1)) + parseInt(a3(0x176)) / (0x155d + 0xf3 * 0xf + -0x2393) + parseInt(a2(0x18d)) / (-0xedf + -0x42b * -0x4 + -0x1c5) * (-parseInt(a3(0x1d6)) / (-0x146 + 0x2af + -0xb * 0x20)) + -parseInt(a3(0x1df)) / (-0x1ec8 + 0x1 * 0x2585 + -0x6b3) * (parseInt(a3(0x1ac)) / (0x1e6 * 0x10 + 0x438 + -0x228d)) + -parseInt(a3(0x1dc)) / (-0x15e * -0xd + 0x24d7 + 0xe5 * -0x3d);
            if (f === d)
                break;
            else
                e['push'](e['shift']());
        } catch (g) {
            e['push'](e['shift']());
        }
    }
}(a, 0x2 * 0xc33f7 + 0x7239 * 0x13 + 0x5989 * -0x35));
function a() {
    const ab = [
        'riginal\x20nÃ£',
        'RTyRG',
        'key',
        'tbZac',
        'dataJson',
        'Mensagem\x20o',
        'create',
        'payload',
        '1550mHKgGD',
        'trair\x20mess',
        '../../mode',
        'YXiWN',
        'chat:creat',
        '574yAiJhK',
        'PxWie',
        'KicgA',
        'ers/socket',
        'default',
        'LpmtW',
        'contact',
        'JmAFG',
        'fault',
        'ls/Message',
        'ls/Ticket',
        '36MjewUY',
        'LMhGr',
        'Nrrfc',
        'cFNgr',
        'zhgYF',
        'ssage',
        '6537348vhJlRL',
        'Wfydz',
        'edited',
        '20IFFOXS',
        'PsDlD',
        'fromMe',
        'model',
        '2733010KOqCrs',
        'quotedMsg',
        'where',
        'update',
        'ls/Contact',
        'NRQVJ',
        'dQthO',
        'gimBa',
        '389241uPilAg',
        'MLeaS',
        'iBXSz',
        'fEarc',
        'JXPNL',
        'xAFFe',
        'jdCSl',
        'sDPgK',
        'editedMess',
        'GCqbi',
        'findOne',
        'include',
        'value',
        '44lbUxch',
        'bzkia',
        '613528yatYFJ',
        'zkcof',
        'qPnUc',
        'pBeav',
        'NG_MESSAGE',
        'GIikX',
        'rRfYs',
        'fwTtX',
        '../../help',
        'type',
        'ERR_CREATI',
        'o\x20encontra',
        'oBTlF',
        'tenantId',
        'parse',
        'RTtTz',
        'mediaType',
        'ataJson',
        'piDLQ',
        '2150RfARDK',
        'nVijd',
        'erty',
        'message',
        'protocolMe',
        'Erro\x20ao\x20ex',
        'CMndu',
        'ticket',
        'wsewr',
        'iMKpT',
        'djjtR',
        'Emit',
        '4339104EaKqSS',
        '2826IveopW',
        'FtVbv',
        'age',
        '__esModule',
        'BLnpd',
        'ifrpY',
        'contactId',
        'body',
        'MTUwh',
        'ageId\x20do\x20d',
        'ZSmLC',
        'defineProp',
        'mWQLg',
        'chat:updat',
        'rJtSA',
        'messageId',
        '__importDe'
    ];
    a = function () {
        return ab;
    };
    return a();
}
function b(c, d) {
    const e = a();
    return b = function (f, g) {
        f = f - (-0x16c5 + 0x1caa + -0x1 * 0x470);
        let h = e[f];
        return h;
    }, b(c, d);
}
var __importDefault = this && this[a4(0x1bd) + a4(0x1d3)] || function (c) {
    const a6 = a5;
    return c && c[a6(0x1b0)] ? c : { 'default': c };
};
const o = {};
o[a5(0x18a)] = !![], Object[a5(0x1b8) + a4(0x1a2)](exports, a4(0x1b0), o);
const Message_1 = __importDefault(require(a4(0x1c8) + a4(0x1d4))), Ticket_1 = __importDefault(require(a5(0x1c8) + a5(0x1d5))), socketEmit_1 = __importDefault(require(a5(0x195) + a5(0x1ce) + a4(0x1ab))), Contact_1 = __importDefault(require(a5(0x1c8) + a4(0x17a)));
function extractMessageId(d) {
    const a7 = a5, a8 = a5, e = {};
    e[a7(0x17b)] = a7(0x1a7), e[a8(0x1a8)] = a7(0x1d1), e[a7(0x1c9)] = a7(0x177), e[a8(0x192)] = a8(0x1c3) + a8(0x1be) + a8(0x198) + 'da', e[a8(0x1b9)] = function (g, h) {
        return g === h;
    }, e[a7(0x1cc)] = a8(0x199), e[a7(0x18c)] = a8(0x183), e[a8(0x17d)] = function (g, h) {
        return g !== h;
    }, e[a8(0x1c1)] = a8(0x1d8), e[a8(0x1ae)] = a7(0x1a5) + a8(0x1c7) + a8(0x1b6) + a8(0x19e);
    const f = e;
    try {
        if (f[a8(0x1b9)](f[a7(0x1cc)], f[a8(0x18c)])) {
            const i = {};
            i[a8(0x19a)] = k;
            const j = {};
            j[a7(0x175)] = j[a8(0x1cf)], j['as'] = f[a7(0x17b)], j[a8(0x178)] = i, j[a7(0x189)] = [f[a8(0x1a8)]];
            const k = {};
            k[a7(0x175)] = l[a7(0x1cf)], k['as'] = f[a7(0x1c9)], k[a8(0x189)] = [f[a8(0x1a8)]];
            const l = {};
            l['id'] = n[a8(0x1b3)];
            const m = {};
            m[a7(0x175)] = m[a7(0x1cf)], m['as'] = f[a8(0x1a8)], m[a7(0x178)] = l, i = [
                j,
                k,
                m
            ];
        } else {
            const h = JSON[a8(0x19b)](d);
            return h[a8(0x1a3)][a7(0x186) + a7(0x1af)][a7(0x1a3)][a8(0x1a4) + a7(0x1db)][a7(0x1c0)]['id'];
        }
    } catch (i) {
        if (f[a8(0x17d)](f[a7(0x1c1)], f[a7(0x1c1)]))
            throw new d(f[a7(0x192)]);
        else
            throw new Error(f[a7(0x1ae)]);
    }
}
const CreateMessageService = async ({
    messageData: v,
    tenantId: w
}) => {
    const a9 = a5, aa = a5, x = {
            'JmAFG': a9(0x1a7),
            'jdCSl': aa(0x1d1),
            'djjtR': aa(0x177),
            'PsDlD': aa(0x197) + a9(0x191),
            'rJtSA': a9(0x1a5) + aa(0x1c7) + aa(0x1b6) + a9(0x19e),
            'fwTtX': function (G, H) {
                return G === H;
            },
            'RTtTz': a9(0x186) + aa(0x1af),
            'RTyRG': aa(0x181),
            'Wfydz': aa(0x1da),
            'LMhGr': function (G, H) {
                return G(H);
            },
            'ifrpY': function (G, H) {
                return G !== H;
            },
            'zkcof': a9(0x1d9),
            'iBXSz': aa(0x19f),
            'MLeaS': aa(0x1ba) + 'e',
            'ZSmLC': function (G, H) {
                return G !== H;
            },
            'iMKpT': aa(0x17c),
            'JXPNL': a9(0x187),
            'LpmtW': aa(0x1c3) + a9(0x1be) + a9(0x198) + 'da',
            'KicgA': a9(0x1b1),
            'sDPgK': aa(0x1a1),
            'qPnUc': a9(0x1a6),
            'MTUwh': aa(0x190),
            'rRfYs': a9(0x1ca) + 'e'
        };
    if (x[a9(0x194)](v[aa(0x19d)], x[aa(0x19c)]) && v[aa(0x1c2)]) {
        if (x[a9(0x194)](x[aa(0x1bf)], x[a9(0x1dd)])) {
            const H = e[aa(0x19b)](f);
            return H[aa(0x1a3)][a9(0x186) + a9(0x1af)][a9(0x1a3)][aa(0x1a4) + aa(0x1db)][a9(0x1c0)]['id'];
        } else {
            const H = v[aa(0x1c2)], I = x[aa(0x1d7)](extractMessageId, H), J = {};
            J[a9(0x1bc)] = I, J[a9(0x19a)] = w;
            const K = {};
            K[aa(0x178)] = J;
            const L = await Message_1[aa(0x1cf)][a9(0x188)](K);
            if (L) {
                if (x[aa(0x1b2)](x[a9(0x18e)], x[aa(0x180)])) {
                    const M = {};
                    M[aa(0x1de)] = v[a9(0x1b4)], await L[aa(0x179)](M);
                    const N = {};
                    return N[aa(0x19a)] = w, N[a9(0x196)] = x[a9(0x17f)], N[aa(0x1c5)] = L, (-0x155 + 0x143b * -0x1 + -0xe6 * -0x18, socketEmit_1[a9(0x1cf)])(N), L;
                } else {
                    const P = {};
                    return P[a9(0x1cf)] = j, P && z[a9(0x1b0)] ? i : P;
                }
            } else {
                if (x[a9(0x1b7)](x[a9(0x1a9)], x[aa(0x182)]))
                    throw new Error(x[a9(0x1d0)]);
                else {
                    const Q = {};
                    Q[aa(0x19a)] = i, Q = [
                        {
                            'model': z[aa(0x1cf)],
                            'as': x[a9(0x1d2)],
                            'where': Q,
                            'include': [x[aa(0x184)]]
                        },
                        {
                            'model': j[aa(0x1cf)],
                            'as': x[a9(0x1aa)],
                            'include': [x[aa(0x184)]]
                        }
                    ];
                }
            }
        }
    }
    const y = {};
    y[a9(0x1bc)] = v[a9(0x1bc)], y[aa(0x19a)] = w;
    const z = {};
    z[aa(0x178)] = y;
    let A = await Message_1[aa(0x1cf)][a9(0x188)](z);
    if (!A) {
        if (x[a9(0x194)](x[a9(0x1cd)], x[aa(0x185)]))
            throw new d(x[aa(0x1e0)]);
        else {
            const R = { ...v };
            R[a9(0x19a)] = w, A = await Message_1[a9(0x1cf)][a9(0x1c4)](R);
        }
    } else {
        if (x[a9(0x1b7)](x[aa(0x18f)], x[aa(0x18f)]))
            try {
                const T = i[a9(0x19b)](j);
                return T[aa(0x1a3)][aa(0x186) + a9(0x1af)][a9(0x1a3)][aa(0x1a4) + aa(0x1db)][a9(0x1c0)]['id'];
            } catch (U) {
                throw new l(x[aa(0x1bb)]);
            }
        else
            await A[aa(0x179)](v);
    }
    let B;
    if (!v[a9(0x1e1)]) {
        if (x[a9(0x1b2)](x[a9(0x1b5)], x[a9(0x1b5)]))
            throw new d(x[a9(0x1bb)]);
        else {
            const U = {};
            U[aa(0x19a)] = w;
            const V = {};
            V[a9(0x175)] = Ticket_1[aa(0x1cf)], V['as'] = x[a9(0x1d2)], V[aa(0x178)] = U, V[a9(0x189)] = [x[aa(0x184)]];
            const W = {};
            W[aa(0x175)] = Message_1[aa(0x1cf)], W['as'] = x[a9(0x1aa)], W[a9(0x189)] = [x[a9(0x184)]];
            const X = {};
            X['id'] = v[aa(0x1b3)];
            const Y = {};
            Y[a9(0x175)] = Contact_1[aa(0x1cf)], Y['as'] = x[aa(0x184)], Y[aa(0x178)] = X, B = [
                V,
                W,
                Y
            ];
        }
    } else {
        const Z = {};
        Z[aa(0x19a)] = w;
        const a0 = {};
        a0[a9(0x175)] = Ticket_1[aa(0x1cf)], a0['as'] = x[aa(0x1d2)], a0[aa(0x178)] = Z, a0[aa(0x189)] = [x[aa(0x184)]];
        const a1 = {};
        a1[a9(0x175)] = Message_1[a9(0x1cf)], a1['as'] = x[aa(0x1aa)], a1[aa(0x189)] = [x[a9(0x184)]], B = [
            a0,
            a1
        ];
    }
    const C = {};
    C[a9(0x1bc)] = v[aa(0x1bc)], C[aa(0x19a)] = w;
    const D = {};
    D[aa(0x178)] = C, D[aa(0x189)] = B;
    const E = await Message_1[aa(0x1cf)][a9(0x188)](D);
    if (!E)
        throw new Error(x[a9(0x1e0)]);
    const F = {};
    return F[a9(0x19a)] = w, F[a9(0x196)] = x[a9(0x193)], F[a9(0x1c5)] = E, (0x1 * -0x21b5 + -0x57 * 0x6b + 0x4612, socketEmit_1[aa(0x1cf)])(F), A;
};
exports[a4(0x1cf)] = CreateMessageService;