'use strict';
const E = b, F = b;
(function (c, d) {
    const C = b, D = b, e = c();
    while (!![]) {
        try {
            const f = parseInt(C(0x23e)) / (-0x15ee + 0x5ee + -0x11 * -0xf1) * (-parseInt(D(0x20c)) / (0x1ebe + 0x18c3 + 0x377f * -0x1)) + parseInt(C(0x233)) / (-0x1 * -0x236b + 0x1186 * 0x1 + -0x34ee) * (parseInt(C(0x237)) / (-0xc0e + -0x255f + 0x3 * 0x107b)) + -parseInt(D(0x248)) / (-0x1 * -0xf67 + 0x446 + -0x13a8) + -parseInt(C(0x255)) / (0x13eb + -0x1 * 0x4a + -0x139b) + -parseInt(C(0x240)) / (0x193 + -0x331 * 0xc + 0x24c0) * (parseInt(D(0x224)) / (0x118f + 0x21 * -0xaf + 0x2 * 0x284)) + parseInt(D(0x1fd)) / (0xeb5 + 0x150f + -0x23bb) * (parseInt(C(0x1fa)) / (0x1af3 + -0xab0 + -0x1 * 0x1039)) + -parseInt(D(0x228)) / (-0x6f6 + 0xb * 0x19f + -0xad4) * (-parseInt(C(0x218)) / (0x236f + -0x1f41 + -0x422));
            if (f === d)
                break;
            else
                e['push'](e['shift']());
        } catch (g) {
            e['push'](e['shift']());
        }
    }
}(a, -0x7a6b4 + -0xf3c60 + 0xdaa * 0x287));
var __importDefault = this && this[E(0x244) + F(0x24f)] || function (c) {
    const G = F;
    return c && c[G(0x23b)] ? c : { 'default': c };
};
function a() {
    const W = [
        'AliOd',
        'ageId',
        '31mHvHKc',
        'mid',
        '7uFmTJH',
        'text',
        'eJBDA',
        'attachment',
        '__importDe',
        'filename',
        'yOYuX',
        'GET',
        '6071670AeCdhV',
        'YOTNB',
        'pipe',
        'DhkYg',
        'ubEzN',
        'vjOCX',
        'message',
        'fault',
        'FjtVk',
        'KjjXP',
        'eStream',
        'QXfny',
        'ERROR\x20DONW',
        '4456440fZyeHg',
        'timestamp',
        'bywoz',
        'ZjHIF',
        'CmrKW',
        'default',
        'mHifX',
        'kMUfx',
        'pUwYk',
        'geService',
        'yLQfP',
        'RGgCo',
        'createWrit',
        'hXbaE',
        'AnuKb',
        'getTime',
        'defineProp',
        'all',
        '10kcycvz',
        'content-di',
        'responseTy',
        '7073145FzxTvm',
        'axios',
        'public',
        'split',
        'VRgKq',
        'messageDat',
        'ohzqr',
        'parse',
        'path',
        'lGKXd',
        'qWQuO',
        'LOAD',
        'cqFTI',
        'message_id',
        'content-ty',
        '66506mRYMTd',
        'OoQPz',
        'type',
        'update',
        'Services/C',
        'ers/getQuo',
        'tenantId',
        'parameters',
        'MeubZ',
        'dTcPI',
        'HlWNG',
        'map',
        '41712xKSUMk',
        'JShTy',
        'payload',
        'erty',
        'stream',
        'error',
        '../../help',
        'RPykf',
        'fromMe',
        'finish',
        'xFJZL',
        'join',
        '9323448feoGHw',
        'sposition',
        'RLKcu',
        'fJWjq',
        '10846tPGoXr',
        'tedForMess',
        'headers',
        'method',
        'reateMessa',
        'hFaQD',
        'url',
        'value',
        'UGgcH',
        '../Message',
        'data',
        '9ngIGrd',
        'iizeA',
        'TmIRU',
        'received',
        '937852nBpoPP',
        'reply_to',
        'MMmMY',
        'gASAL',
        '__esModule'
    ];
    a = function () {
        return W;
    };
    return a();
}
const w = {};
w[F(0x22f)] = !![], Object[F(0x1f8) + E(0x21b)](exports, F(0x23b), w);
function b(c, d) {
    const e = a();
    return b = function (f, g) {
        f = f - (-0x12 * -0x1a2 + 0x83 * -0x1f + -0xb9d);
        let h = e[f];
        return h;
    }, b(c, d);
}
const path_1 = require(E(0x205)), axios_1 = __importDefault(require(E(0x1fe))), fs_1 = require('fs'), content_disposition_1 = __importDefault(require(E(0x1fb) + E(0x225))), CreateMessageService_1 = __importDefault(require(E(0x231) + E(0x210) + F(0x22c) + E(0x1f1))), getQuotedForMessageId_1 = __importDefault(require(F(0x21e) + E(0x211) + F(0x229) + F(0x23d))), downloadFile = async (e, f) => {
        const H = F, I = F, g = {
                'bywoz': H(0x254) + H(0x208),
                'mHifX': function (o, p) {
                    return o(p);
                },
                'AliOd': H(0x221),
                'QXfny': H(0x21d),
                'hXbaE': function (o, p) {
                    return o !== p;
                },
                'RGgCo': H(0x216),
                'yLQfP': H(0x1f6),
                'KjjXP': H(0x219),
                'MMmMY': I(0x247),
                'fJWjq': H(0x21c),
                'ohzqr': I(0x1fb) + I(0x225),
                'CmrKW': H(0x21f),
                'FjtVk': function (o, p) {
                    return o === p;
                },
                'kMUfx': I(0x249),
                'xFJZL': I(0x24c),
                'qWQuO': H(0x20b) + 'pe',
                'hFaQD': H(0x1ff)
            }, h = {};
        h[H(0x22e)] = e, h[I(0x22b)] = g[I(0x239)], h[H(0x1fc) + 'pe'] = g[I(0x227)];
        const i = await (-0x1327 + -0x3af + 0x4f * 0x4a, axios_1[I(0x1ed)])(h), j = {};
        j[H(0x213)] = {};
        const k = i[H(0x22a)][g[I(0x203)]] ? content_disposition_1[H(0x1ed)][H(0x204)](i[I(0x22a)][g[H(0x203)]] || '') : j;
        let l = '';
        const m = k?.[I(0x213)]?.[I(0x245)];
        if (m) {
            if (g[I(0x1f5)](g[I(0x1ec)], g[I(0x1ec)]))
                h[I(0x21d)](g[H(0x1ea)], i), g[H(0x1ee)](j, new k(l));
            else {
                const p = k[H(0x213)][I(0x245)];
                l = new Date()[I(0x1f7)]() + '-' + p;
            }
        } else {
            if (g[I(0x250)](g[H(0x1ef)], g[I(0x222)])) {
                const r = {};
                return r[H(0x1ed)] = j, g && h[I(0x23b)] ? i : r;
            } else {
                const r = i[H(0x22a)][g[I(0x207)]], s = r[H(0x200)]('/')[0x4b9 + -0x49 * -0x20 + -0xdd8];
                l = f + '-' + new Date()[H(0x1f7)]() + '.' + s;
            }
        }
        const n = (-0x86a + -0x1 * 0x12ea + -0x1b54 * -0x1, path_1[H(0x223)])(__dirname, '..', '..', '..', g[H(0x22d)], l);
        return await new Promise((t, u) => {
            const J = I, L = H, v = {
                    'DhkYg': g[J(0x1ea)],
                    'UGgcH': function (x, y) {
                        const K = J;
                        return g[K(0x1ee)](x, y);
                    },
                    'ZjHIF': g[J(0x23c)],
                    'MeubZ': g[L(0x253)],
                    'dTcPI': function (z, A) {
                        const M = J;
                        return g[M(0x1f5)](z, A);
                    },
                    'iizeA': g[L(0x1f3)]
                };
            if (g[J(0x1f5)](g[J(0x1f2)], g[L(0x251)]))
                i[J(0x232)][J(0x24a)]((-0x17f4 + -0xd5 * 0x4 + -0x12 * -0x184, fs_1[L(0x1f4) + J(0x252)])(n))['on'](g[L(0x23c)], async () => t(l))['on'](g[J(0x253)], x => {
                    const N = L, O = L;
                    if (v[N(0x215)](v[N(0x234)], v[O(0x234)])) {
                        const z = {
                            'RLKcu': v[N(0x24b)],
                            'yOYuX': function (A, B) {
                                const P = N;
                                return v[P(0x230)](A, B);
                            }
                        };
                        k[O(0x232)][N(0x24a)]((-0xc3e + -0x1eae + 0x2aec, l[O(0x1f4) + N(0x252)])(m))['on'](v[N(0x1eb)], async () => s(t))['on'](v[O(0x214)], A => {
                            const Q = N, R = O;
                            s[Q(0x21d)](z[R(0x226)], A), z[Q(0x246)](t, new u(A));
                        });
                    } else
                        console[N(0x21d)](v[O(0x24b)], x), v[N(0x230)](u, new Error(x));
                });
            else {
                const y = f[L(0x213)][J(0x245)];
                g = new h()[L(0x1f7)]() + '-' + y;
            }
        }), l;
    }, MessengerVerifyMediaMessage = async (c, d, e, f) => {
        const S = E, T = E, g = {
                'TmIRU': S(0x20b) + 'pe',
                'gASAL': function (i, j, k) {
                    return i(j, k);
                },
                'OoQPz': function (i, j) {
                    return i === j;
                },
                'VRgKq': S(0x24d),
                'eJBDA': S(0x206),
                'cqFTI': function (i, j) {
                    return i > j;
                },
                'pUwYk': S(0x236)
            };
        let h;
        await Promise[S(0x1f9)](d[S(0x24e)][S(0x243) + 's'][T(0x217)](async (i, j) => {
            const U = S, V = T, k = e['id'] + '_' + d[U(0x20a)];
            h = await g[U(0x23a)](downloadFile, i[V(0x21a)][U(0x22e)], k);
            let l;
            if (d?.[U(0x24e)]?.[V(0x238)]?.[U(0x23f)]) {
                if (g[U(0x20d)](g[U(0x201)], g[U(0x242)])) {
                    const p = g[U(0x22a)][g[V(0x235)]], q = p[V(0x200)]('/')[0xe13 * -0x1 + 0x1296 + -0x482 * 0x1];
                    h = i + '-' + new j()[V(0x1f7)]() + '.' + q;
                } else {
                    const p = await (-0x2 * 0x240 + -0x39 * -0x8f + 0x1 * -0x1b57, getQuotedForMessageId_1[V(0x1ed)])(d[U(0x24e)][U(0x238)][U(0x23f)], e[V(0x212)]);
                    l = p?.['id'] || undefined;
                }
            }
            const m = {
                'messageId': g[V(0x209)](j, -0x1 * 0x1d75 + -0x2482 + 0x41f7) ? d[V(0x20a)] + '__' + j : d[U(0x20a)] || '',
                'ticketId': e['id'],
                'contactId': f['id'],
                'body': d[V(0x24e)]?.[V(0x241)] || '',
                'fromMe': d[V(0x220)],
                'read': ![],
                'mediaUrl': h,
                'mediaType': d[U(0x20e)],
                'quotedMsgId': l,
                'timestamp': +d[U(0x256)],
                'status': g[V(0x1f0)]
            };
            await e[V(0x20f)]({
                'lastMessage': d[U(0x24e)]?.[V(0x241)] || h || '',
                'lastMessageAt': new Date()[V(0x1f7)](),
                'answered': ![]
            });
            const n = {};
            n[V(0x202) + 'a'] = m, n[U(0x212)] = e[U(0x212)], await (0x3 * -0xd4 + 0xf11 + -0xc95 * 0x1, CreateMessageService_1[U(0x1ed)])(n);
        }));
    };
exports[F(0x1ed)] = MessengerVerifyMediaMessage;