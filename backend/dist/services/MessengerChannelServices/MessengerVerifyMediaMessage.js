'use strict';
const E = b, F = b;
(function (c, d) {
    const C = b, D = b, e = c();
    while (!![]) {
        try {
            const f = parseInt(C(0x21b)) / (0x1 * 0x805 + 0x108d + -0x1891) + -parseInt(C(0x1d6)) / (0x3cd * 0x3 + -0x1d3 + -0x1 * 0x992) + parseInt(D(0x1f0)) / (0x1bf5 * -0x1 + 0xeca + 0x1e2 * 0x7) + -parseInt(C(0x1cf)) / (0x7 * 0x199 + -0x3 * -0x32d + -0x14b2 * 0x1) * (-parseInt(D(0x200)) / (-0x5 * -0x233 + -0xf5 * -0x19 + 0x1 * -0x22e7)) + -parseInt(C(0x1fc)) / (-0xb * -0x21 + 0x89a + -0x9ff) * (parseInt(C(0x20e)) / (0x24b * -0x11 + -0x7 * -0x3be + 0xcd0)) + parseInt(D(0x1ce)) / (0x1aad * 0x1 + -0x8d1 + -0x2 * 0x8ea) + -parseInt(C(0x1ee)) / (-0x422 + -0x772 * -0x4 + -0x199d);
            if (f === d)
                break;
            else
                e['push'](e['shift']());
        } catch (g) {
            e['push'](e['shift']());
        }
    }
}(a, -0x56 * -0x1c59 + 0x1e641 + 0x688d * -0x3));
function a() {
    const T = [
        'parse',
        '657785uaBYhS',
        'default',
        'received',
        'Services/C',
        'fault',
        'text',
        'UeynI',
        'oLIFn',
        'ers/getQuo',
        'data',
        'ONrgo',
        'sposition',
        'timestamp',
        'fromMe',
        'uBnYo',
        'payload',
        'attachment',
        'createWrit',
        'url',
        '5939768MFMGgP',
        '2548flOUge',
        'all',
        'headers',
        'CpQlv',
        'update',
        'defineProp',
        'fDLas',
        '1666788PHtXHv',
        '../Message',
        'mid',
        'BquDG',
        'ageId',
        'gVvAE',
        'XFofa',
        'geService',
        'reateMessa',
        'getTime',
        'xcQBA',
        'content-di',
        'type',
        'xHMRI',
        'fsHfa',
        'jDfoA',
        'ERROR\x20DONW',
        'parameters',
        'zTjQe',
        'public',
        'message',
        'tPaPT',
        'tedForMess',
        'map',
        '5508189zWpriW',
        'DVtzf',
        '1725762QVSRLv',
        'join',
        '__importDe',
        'value',
        'messageDat',
        'GET',
        '__esModule',
        'PYCvl',
        '../../help',
        'AwTPB',
        'error',
        'TKjSM',
        '492amqypc',
        'axios',
        'reply_to',
        'finish',
        '8755AyWcdy',
        'IJJYe',
        'RasNr',
        'tenantId',
        'stream',
        'path',
        'filename',
        'method',
        'LOAD',
        'VHLOv',
        'responseTy',
        'YQYdD',
        'QDjZG',
        'iTNDv',
        '83419hyuptH',
        'split',
        'EJdtB',
        'rYYfi',
        'pipe',
        'content-ty',
        'erty',
        'fIJft',
        'message_id',
        'eStream',
        'KmPYF',
        'ybsUf'
    ];
    a = function () {
        return T;
    };
    return a();
}
var __importDefault = this && this[E(0x1f2) + E(0x21f)] || function (c) {
    const G = F;
    return c && c[G(0x1f6)] ? c : { 'default': c };
};
function b(c, d) {
    const e = a();
    return b = function (f, g) {
        f = f - (-0x32 * -0x42 + -0xe3b * -0x1 + -0x1959);
        let h = e[f];
        return h;
    }, b(c, d);
}
const w = {};
w[E(0x1f3)] = !![], Object[F(0x1d4) + F(0x214)](exports, E(0x1f6), w);
const path_1 = require(E(0x205)), axios_1 = __importDefault(require(F(0x1fd))), fs_1 = require('fs'), content_disposition_1 = __importDefault(require(E(0x1e1) + E(0x1c6))), CreateMessageService_1 = __importDefault(require(E(0x1d7) + E(0x21e) + E(0x1de) + F(0x1dd))), getQuotedForMessageId_1 = __importDefault(require(F(0x1f8) + E(0x223) + E(0x1ec) + F(0x1da))), downloadFile = async (e, f) => {
        const H = E, I = E, g = {
                'XFofa': H(0x1e6) + I(0x208),
                'IJJYe': function (o, p) {
                    return o(p);
                },
                'VHLOv': H(0x1ff),
                'QDjZG': I(0x1fa),
                'KmPYF': function (o, p) {
                    return o !== p;
                },
                'ONrgo': H(0x221),
                'ybsUf': I(0x1e0),
                'rYYfi': H(0x213) + 'pe',
                'RasNr': function (o, p) {
                    return o !== p;
                },
                'iTNDv': H(0x20b),
                'oLIFn': I(0x1f5),
                'xHMRI': I(0x204),
                'fDLas': H(0x1e1) + I(0x1c6),
                'CpQlv': function (o, p) {
                    return o !== p;
                },
                'zTjQe': H(0x1ef),
                'EJdtB': function (o, p) {
                    return o === p;
                },
                'tPaPT': H(0x1f9),
                'uBnYo': H(0x1e9)
            }, h = {};
        h[H(0x1cd)] = e, h[I(0x207)] = g[I(0x222)], h[I(0x20a) + 'pe'] = g[H(0x1e3)];
        const i = await (-0x206e + -0x163b + 0x36a9, axios_1[I(0x21c)])(h), j = {};
        j[H(0x1e7)] = {};
        const k = i[H(0x1d1)][g[I(0x1d5)]] ? content_disposition_1[H(0x21c)][I(0x21a)](i[H(0x1d1)][g[I(0x1d5)]] || '') : j;
        let l = '';
        const m = k?.[H(0x1e7)]?.[H(0x206)];
        if (m) {
            if (g[I(0x1d2)](g[H(0x1e8)], g[H(0x1e8)]))
                h[I(0x1fa)](g[H(0x1dc)], i), g[H(0x201)](j, new k(l));
            else {
                const p = k[I(0x1e7)][H(0x206)];
                l = new Date()[H(0x1df)]() + '-' + p;
            }
        } else {
            if (g[H(0x210)](g[H(0x1eb)], g[H(0x1eb)])) {
                const q = i[I(0x1d1)][g[I(0x211)]], r = q[I(0x20f)]('/')[0x262c + 0x1758 + -0x3d83];
                l = f + '-' + new Date()[I(0x1df)]() + '.' + r;
            } else
                k[H(0x224)][H(0x212)]((-0x1 * 0x20e1 + 0x35c * 0x4 + 0x15 * 0xed, l[I(0x1cc) + H(0x217)])(m))['on'](g[H(0x209)], async () => s(t))['on'](g[H(0x20c)], x => {
                    const J = H, K = I;
                    s[J(0x1fa)](g[K(0x1dc)], x), g[K(0x201)](t, new u(x));
                });
        }
        const n = (-0x36 * -0x40 + 0x1725 + 0x1 * -0x24a5, path_1[H(0x1f1)])(__dirname, '..', '..', '..', g[I(0x1c9)], l);
        return await new Promise((t, u) => {
            const L = H, M = I, v = {};
            v[L(0x1db)] = g[M(0x211)];
            const x = v;
            if (g[L(0x202)](g[M(0x20d)], g[L(0x20d)])) {
                const z = g[L(0x1d1)][x[M(0x1db)]], A = z[L(0x20f)]('/')[-0x1f25 + 0x171f * 0x1 + 0x807];
                h = i + '-' + new j()[M(0x1df)]() + '.' + A;
            } else
                i[M(0x224)][L(0x212)]((-0x5 * 0x7cb + -0x2f * -0x65 + 0x146c, fs_1[M(0x1cc) + M(0x217)])(n))['on'](g[L(0x209)], async () => t(l))['on'](g[L(0x20c)], z => {
                    const N = M, O = M;
                    if (g[N(0x218)](g[N(0x225)], g[N(0x219)]))
                        console[N(0x1fa)](g[N(0x1dc)], z), g[O(0x201)](u, new Error(z));
                    else {
                        const B = {};
                        return B[O(0x21c)] = j, g && h[N(0x1f6)] ? i : B;
                    }
                });
        }), l;
    }, MessengerVerifyMediaMessage = async (c, d, e, f) => {
        const P = E, Q = E, g = {
                'jDfoA': function (i, j, k) {
                    return i(j, k);
                },
                'fIJft': function (i, j) {
                    return i === j;
                },
                'fsHfa': P(0x1fb),
                'BquDG': function (i, j) {
                    return i > j;
                },
                'PYCvl': Q(0x21d)
            };
        let h;
        await Promise[P(0x1d0)](d[P(0x1ea)][P(0x1cb) + 's'][Q(0x1ed)](async (i, j) => {
            const R = Q, S = P, k = e['id'] + '_' + d[R(0x216)];
            h = await g[R(0x1e5)](downloadFile, i[R(0x1ca)][S(0x1cd)], k);
            let l;
            if (d?.[S(0x1ea)]?.[S(0x1fe)]?.[R(0x1d8)]) {
                if (g[S(0x215)](g[S(0x1e4)], g[R(0x1e4)])) {
                    const o = await (0x2154 + 0x1ad7 + 0x1 * -0x3c2b, getQuotedForMessageId_1[R(0x21c)])(d[S(0x1ea)][R(0x1fe)][R(0x1d8)], e[R(0x203)]);
                    l = o?.['id'] || undefined;
                } else {
                    const q = f[R(0x1e7)][R(0x206)];
                    g = new h()[R(0x1df)]() + '-' + q;
                }
            }
            const m = {
                'messageId': g[S(0x1d9)](j, -0x15d0 + 0x428 + -0x1 * -0x11a8) ? d[R(0x216)] + '__' + j : d[S(0x216)] || '',
                'ticketId': e['id'],
                'contactId': f['id'],
                'body': d[R(0x1ea)]?.[S(0x220)] || '',
                'fromMe': d[R(0x1c8)],
                'read': ![],
                'mediaUrl': h,
                'mediaType': d[R(0x1e2)],
                'quotedMsgId': l,
                'timestamp': +d[S(0x1c7)],
                'status': g[S(0x1f7)]
            };
            await e[S(0x1d3)]({
                'lastMessage': d[S(0x1ea)]?.[R(0x220)] || h || '',
                'lastMessageAt': new Date()[R(0x1df)](),
                'answered': ![]
            });
            const n = {};
            n[R(0x1f4) + 'a'] = m, n[R(0x203)] = e[S(0x203)], await (-0x1c28 + -0x4fc + -0x586 * -0x6, CreateMessageService_1[S(0x21c)])(n);
        }));
    };
exports[E(0x21c)] = MessengerVerifyMediaMessage;