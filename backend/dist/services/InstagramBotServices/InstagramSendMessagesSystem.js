'use strict';
function b(c, d) {
    const e = a();
    return b = function (f, g) {
        f = f - (0x683 * 0x4 + 0x4 * 0x539 + 0xb * -0x43a);
        let h = e[f];
        return h;
    }, b(c, d);
}
function a() {
    const a0 = [
        'default',
        'ideo',
        '2sBffnK',
        'ls/Message',
        'id:\x20',
        'Wupno',
        'defineProp',
        '1338848MmoTrk',
        'ls/Ticket',
        'toBuffer',
        'quotedMsg',
        'hoto',
        'sended',
        'ack',
        'CvqWy',
        'mp4',
        'public',
        '1070635QlUGwz',
        's/logger',
        'broadcastV',
        'Error\x20send',
        'date\x20ok',
        'EthKu',
        'info',
        'fs/promise',
        'qYCpQ',
        'kkclN',
        'SggxI',
        'ShBtx',
        'join',
        '.mp4',
        'video',
        'sleepRando',
        'includes',
        'ptt',
        'dataValues',
        '134271mhHVFi',
        'where',
        'closed',
        'Message\x20Up',
        'entity',
        'erty',
        'vHDNB',
        '__importDe',
        'gHWiU',
        '20092IYbjjr',
        'ers/socket',
        'file',
        'text',
        'dJgsC',
        '../../mode',
        ')::\x20',
        'woQHx',
        'age\x20is\x20(te',
        'ASC',
        'HHUEn',
        'image',
        'directThre',
        'value',
        'payload',
        'createdAt',
        'mediaType',
        'broadcastT',
        'mediaName',
        '\x20message\x20(',
        'broadcastP',
        's/sleepRan',
        'findAll',
        'logger',
        'tenantId',
        'pending',
        'pFqcy',
        'YtvTm',
        '__esModule',
        'error',
        'contact',
        'timestamp',
        'ogiEo',
        'fault',
        'e\x20text',
        'mediaUrl',
        'chat:ack',
        'gVipB',
        '1591016jrTXOz',
        'saveToFile',
        'peg',
        'sequelize',
        'body',
        '../../util',
        'mXqHx',
        'type',
        'end',
        'xPBdr',
        'sendMessag',
        '\x20|\x20Ticket:',
        'TsQvf',
        'mTime',
        '132VjmXxU',
        'jpeg',
        'messageId',
        'readFile',
        'fXQII',
        'ticket',
        'toFormat',
        'rOtvr',
        'WktUS',
        'wYtZZ',
        'e\x20media',
        'path',
        'sharp',
        'Error\x20mess',
        'log',
        'update',
        '95287wYMDyT',
        'umuyp',
        'Emit',
        'status',
        'oice',
        'lte',
        'domTime',
        'fluent-ffm',
        'kBxwh',
        'chat',
        'nant:\x20',
        '../../help',
        'item_id',
        'instagram',
        'ext',
        'split',
        'audio',
        'instagramP',
        '10AHnUIE',
        'qeeLU',
        '1885332QNKgDx'
    ];
    a = function () {
        return a0;
    };
    return a();
}
const T = b, U = b;
(function (c, d) {
    const R = b, S = b, e = c();
    while (!![]) {
        try {
            const f = -parseInt(R(0xf2)) / (0x14d + -0x4 * 0x3e8 + 0xe54) * (-parseInt(R(0x83)) / (-0x7 * 0x2b6 + 0x21a * 0xd + -0x856 * 0x1)) + parseInt(S(0xe2)) / (-0x2687 + -0x14 * 0xa7 + 0x3396) * (parseInt(R(0xae)) / (-0x2a * 0xb1 + 0x2275 * 0x1 + 0x1cd * -0x3)) + parseInt(S(0x92)) / (0x37 * -0x9d + 0x2533 + -0x373) + -parseInt(R(0x80)) / (0x1450 + -0xa65 * 0x1 + -0x9e5) + -parseInt(S(0xd4)) / (-0x105d + 0x1 * 0x1ff3 + -0xf8f) + parseInt(R(0x88)) / (0x14fd * 0x1 + -0xd * 0x99 + -0x10 * 0xd3) + -parseInt(R(0xa5)) / (0x1298 + -0x5f6 + -0xc99) * (-parseInt(R(0x7e)) / (-0x673 * 0x3 + 0x1fea + -0x42d * 0x3));
            if (f === d)
                break;
            else
                e['push'](e['shift']());
        } catch (g) {
            e['push'](e['shift']());
        }
    }
}(a, -0xf0c1 + 0x129ff * 0x3 + 0xf7b));
var __importDefault = this && this[T(0xac) + T(0xcf)] || function (c) {
    const V = T;
    return c && c[V(0xca)] ? c : { 'default': c };
};
const q = {};
q[T(0xbb)] = !![], Object[T(0x87) + T(0xaa)](exports, U(0xca), q);
const promises_1 = require(T(0x99) + 's'), fluent_ffmpeg_1 = __importDefault(require(T(0x73) + U(0xd6))), path_1 = require(T(0xed)), sequelize_1 = require(U(0xd7)), sharp_1 = __importDefault(require(U(0xee))), socketEmit_1 = __importDefault(require(T(0x77) + U(0xaf) + U(0xf4))), Message_1 = __importDefault(require(U(0xb3) + T(0x84))), Ticket_1 = __importDefault(require(U(0xb3) + U(0x89))), logger_1 = require(T(0xd9) + U(0x93)), sleepRandomTime_1 = require(U(0xd9) + T(0xc3) + T(0x72)), SendMessagesSystemWbot = async (l, m) => {
        const W = U, X = U, n = {
                'pFqcy': W(0x90),
                'umuyp': W(0xcb),
                'EthKu': W(0xdc),
                'qYCpQ': X(0xc7),
                'woQHx': W(0xcc),
                'dJgsC': X(0xe7),
                'SggxI': X(0xa7),
                'qeeLU': W(0x79),
                'HHUEn': W(0x8b),
                'kkclN': X(0xbd),
                'gVipB': W(0xb7),
                'kBxwh': W(0x75),
                'WktUS': W(0xb1),
                'Wupno': W(0x91),
                'gHWiU': function (t, u) {
                    return t === u;
                },
                'fXQII': X(0x7c),
                'xPBdr': W(0xa3),
                'wYtZZ': X(0xb9),
                'CvqWy': function (t, u) {
                    return t === u;
                },
                'vHDNB': W(0xa0),
                'mXqHx': W(0xde) + W(0xec),
                'TsQvf': X(0xde) + W(0xd0),
                'rOtvr': X(0x8d),
                'ogiEo': W(0xd2),
                'ShBtx': W(0xa8) + W(0x96),
                'YtvTm': function (t, u) {
                    return t(u);
                }
            }, o = { [sequelize_1['Op']['is']]: null }, p = {
                'fromMe': !![],
                'messageId': o,
                'status': n[X(0x9a)],
                [sequelize_1['Op']['or']]: [
                    { 'scheduleDate': { [sequelize_1['Op'][W(0xf7)]]: new Date() } },
                    { 'scheduleDate': { [sequelize_1['Op']['is']]: null } }
                ]
            }, r = await Message_1[X(0x81)][X(0xc4)]({
                'where': p,
                'include': [
                    n[X(0xb5)],
                    {
                        'model': Ticket_1[X(0x81)],
                        'as': n[W(0xb2)],
                        'where': {
                            'tenantId': m,
                            [sequelize_1['Op']['or']]: {
                                'status': { [sequelize_1['Op']['ne']]: n[X(0x9c)] },
                                'isFarewellMessage': !![]
                            },
                            'channel': n[W(0x7f)],
                            'whatsappId': l['id']
                        },
                        'include': [n[W(0xb5)]]
                    },
                    {
                        'model': Message_1[X(0x81)],
                        'as': n[X(0xb8)],
                        'include': [n[X(0xb5)]]
                    }
                ],
                'order': [[
                        n[W(0x9b)],
                        n[X(0xd3)]
                    ]]
            });
        let s;
        for (const t of r) {
            const u = t, {ticket: v} = u, w = v[W(0xcc)][W(0x7d) + 'K'], x = await l[W(0xa9)][X(0xba) + 'ad']([w]);
            try {
                if (![
                        n[W(0x74)],
                        n[W(0xea)]
                    ][X(0xa2)](u[X(0xbe)]) && u[W(0xc0)]) {
                    const E = (-0x5 * 0x6cf + 0x2 * 0xcfb + -0x1 * -0x815, path_1[X(0x9e)])(__dirname, '..', '..', '..', n[X(0x86)]), F = (0x3 * 0x1b9 + 0x1485 + -0x19b0, path_1[X(0x9e)])(E, u[W(0xc0)]), G = await (-0x110b * 0x2 + 0xd * -0x219 + 0x3d5b, promises_1[X(0xe5)])(F);
                    console[X(0xf0)](F);
                    if (n[W(0xad)](u[W(0xbe)], n[X(0xe6)]) || n[W(0xad)](u[W(0xbe)], n[W(0xdd)])) {
                        const H = u[X(0xc0)][X(0x7b)]('.'), I = (0x1 * 0x2bd + -0x3 * -0xbdd + -0x1be * 0x16, path_1[W(0x9e)])(E, H[0x1689 + -0x4 * -0x4be + -0x2981] + X(0x9f));
                        await new Promise((L, M) => {
                            const Y = W, Z = W;
                            (0xad7 * -0x1 + 0xee3 + 0x94 * -0x7, fluent_ffmpeg_1[Y(0x81)])(F)[Y(0xe8)](n[Y(0xc8)])['on'](n[Y(0xf3)], N => M(N))['on'](n[Y(0x97)], () => L(!![]))[Z(0xd5)](I);
                        });
                        const J = await (-0x1701 + -0x91 * 0x3d + 0x398e, promises_1[X(0xe5)])(I), K = {};
                        K[W(0xb0)] = J, s = await x[X(0x94) + X(0xf6)](K);
                    }
                    if (n[W(0xad)](u[W(0xbe)], n[X(0xeb)])) {
                        const L = await (-0x1fac + 0x1 * -0x18eb + 0x3897, sharp_1[X(0x81)])(G)[X(0xe3)]()[W(0x8a)](), M = {};
                        M[X(0xb0)] = L, s = await x[W(0xc2) + W(0x8c)](M);
                    }
                    if (n[W(0x8f)](u[X(0xbe)], n[W(0xab)])) {
                        const N = {};
                        N[X(0xa0)] = G, s = await x[X(0x94) + X(0x82)](N);
                    }
                    logger_1[W(0xc5)][X(0x98)](n[W(0xda)]);
                }
                [
                    n[X(0x74)],
                    n[X(0xea)]
                ][X(0xa2)](u[W(0xbe)]) && !u[W(0xc0)] && (s = await x[X(0xbf) + X(0x7a)](u[W(0xd8)]), logger_1[X(0xc5)][X(0x98)](n[X(0xe0)]));
                const y = {
                    ...u,
                    ...s
                };
                y['id'] = u['id'], y[X(0xcd)] = u[W(0xcd)], y[W(0xe4)] = s[W(0x78)], y[W(0xf5)] = n[X(0xe9)], y[X(0x8e)] = 0x2;
                const z = y, A = { ...z }, B = {};
                B['id'] = u['id'];
                const C = {};
                C[W(0xa6)] = B, await Message_1[X(0x81)][X(0xf1)](A, C);
                const D = {};
                D[X(0xc6)] = v[W(0xc6)], D[W(0xdb)] = n[X(0xce)], D[X(0xbc)] = { ...u[X(0xa4)] }, D[X(0xbc)][X(0xd1)] = u[W(0xd1)], D[X(0xbc)]['id'] = u['id'], D[X(0xbc)][X(0xcd)] = u[X(0xcd)], D[X(0xbc)][X(0xe4)] = s[W(0x78)], D[X(0xbc)][X(0xf5)] = n[W(0xe9)], D[X(0xbc)][X(0x8e)] = 0x2, (-0x1bac + -0x130f + 0x2ebb, socketEmit_1[X(0x81)])(D), logger_1[X(0xc5)][W(0x98)](n[X(0x9d)]), await (0x1 * -0x2479 + 0x1745 + 0xd34, sleepRandomTime_1[W(0xa1) + X(0xe1)])({
                    'minMilliseconds': n[W(0xc9)](Number, 0x295 * -0xa + -0x12e * 0x20 + 0x4762 * 0x1),
                    'maxMilliseconds': n[X(0xc9)](Number, -0x953 + -0x3b * 0x8c + 0x354f * 0x1)
                });
            } catch (O) {
                const P = u['id'], Q = u[W(0xe7)]['id'];
                logger_1[W(0xc5)][W(0xcb)](W(0xef) + W(0xb6) + X(0x76) + m + (W(0xdf) + '\x20') + Q + ')'), logger_1[X(0xc5)][W(0xcb)](X(0x95) + W(0xc1) + X(0x85) + P + X(0xb4) + O);
            }
        }
    };
exports[U(0x81)] = SendMessagesSystemWbot;