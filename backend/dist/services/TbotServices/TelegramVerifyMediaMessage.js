'use strict';
const E = b, F = b;
function a() {
    const V = [
        'ukOMM',
        'caption',
        'QAHdY',
        'Vpdlu',
        'ers/getQuo',
        's/logger',
        'ipAHc',
        'reJGq',
        '4hHaDMQ',
        'video',
        'createWrit',
        'image/png',
        'gNZZb',
        '__esModule',
        '82bvyPMw',
        'xzRLV',
        'itFPn',
        'writeFile',
        'is_animate',
        'EbGiW',
        'erty',
        'bTVbr',
        'AjJyO',
        'xgcYO',
        'received',
        'file_id',
        'sended',
        'mimeType',
        'fnXCX',
        'ASvBd',
        'fileId',
        'messageDat',
        'aNJuV',
        'edited_mes',
        'geService',
        'promisify',
        'eStream',
        'DdNrz',
        'JralH',
        'SAD',
        'YCYDf',
        'lMbAN',
        'UcMGG',
        'EXbOg',
        'audio',
        'fault',
        'ecaUT',
        'PClEw',
        'Lotyu',
        'PaHLY',
        'knhLT',
        'fileName',
        'type',
        'eJZYp',
        'mime_type',
        'JCUpv',
        'default',
        'wEQtn',
        'vnhzQ',
        'tedForMess',
        'sage',
        '1998bbQvro',
        'message_id',
        'baOYr',
        'oLTOu',
        'text',
        'data',
        'reateMessa',
        'update',
        'SAV',
        'uMBxz',
        'SAS',
        '../../help',
        'telegram',
        'path',
        'reply_to_m',
        'split',
        'photo',
        'image/webp',
        'aSLMq',
        'rcXGK',
        '__importDe',
        'IUSvo',
        'CMQfe',
        'sticker',
        '81993azlsjB',
        'OyFUm',
        'ERROR\x20DONW',
        'document',
        'public',
        'essage',
        'HWbuF',
        'GET',
        'iLAKq',
        '../Message',
        'AD_MEDIA::',
        '7FCpxck',
        'ageId',
        'getTime',
        '8032250lCKEcR',
        'getFileLin',
        'CAyTq',
        '1351615XWzhPX',
        'VAFbx',
        'file_name',
        'value',
        'Services/C',
        '4957890JVJGJJ',
        'toString',
        'length',
        'logger',
        'ERR_DOWNLO',
        'date',
        'message',
        'GFccu',
        'AfkyM',
        'JCxfQ',
        'tenantId',
        'stream',
        '../../util',
        'axios',
        'voice',
        'hluFo',
        '473723WpOdhR',
        'error',
        'XWeET',
        'eDGdn',
        'pipe',
        'zmUMm',
        '\x20ID:\x20',
        'getFile',
        '3832cdnJyi',
        'YCXGj',
        'util',
        'finish',
        'join',
        'defineProp',
        'LOAD',
        '41918602usbuXt'
    ];
    a = function () {
        return V;
    };
    return a();
}
(function (c, d) {
    const C = b, D = b, e = c();
    while (!![]) {
        try {
            const f = -parseInt(C(0x1d4)) / (0x946 * -0x2 + 0x1 * -0x7b9 + 0x461 * 0x6) + parseInt(D(0x1f2)) / (-0x1e6 * 0xc + 0x17bc + 0x16 * -0xb) * (-parseInt(C(0x239)) / (-0x2db * 0x6 + 0x6ea + 0xa3b)) + -parseInt(C(0x1ec)) / (0x400 + 0xf91 + 0x7 * -0x2cb) * (-parseInt(D(0x24a)) / (-0x2371 + 0x1 * -0xae5 + -0x1 * -0x2e5b)) + parseInt(C(0x24f)) / (-0x21a * -0xa + 0x6 * -0x71 + -0x1258) * (-parseInt(C(0x244)) / (-0x1 * 0x386 + -0x7 * -0x305 + 0x8cb * -0x2)) + parseInt(C(0x1dc)) / (-0x1 * 0x38d + 0xfcb + -0x3 * 0x412) * (parseInt(D(0x221)) / (0x161 * 0xf + -0x15d2 * -0x1 + -0x2a78)) + -parseInt(C(0x247)) / (0x1b03 + -0x2434 + 0x93b * 0x1) + parseInt(D(0x1e3)) / (0x1 * -0x2221 + 0x1d17 + 0x1 * 0x515);
            if (f === d)
                break;
            else
                e['push'](e['shift']());
        } catch (g) {
            e['push'](e['shift']());
        }
    }
}(a, -0x15d05 + 0x2b033 * 0x1 + 0xd60eb));
var __importDefault = this && this[E(0x235) + F(0x211)] || function (c) {
    const G = E;
    return c && c[G(0x1f1)] ? c : { 'default': c };
};
const u = {};
function b(c, d) {
    const e = a();
    return b = function (f, g) {
        f = f - (-0xd9 + -0xc94 + 0x3d * 0x40);
        let h = e[f];
        return h;
    }, b(c, d);
}
u[F(0x24d)] = !![], Object[E(0x1e1) + E(0x1f8)](exports, F(0x1f1), u);
const path_1 = require(F(0x22e)), util_1 = require(F(0x1de)), fs_1 = require('fs'), axios_1 = __importDefault(require(F(0x25c))), CreateMessageService_1 = __importDefault(require(E(0x242) + F(0x24e) + E(0x227) + E(0x206))), logger_1 = require(E(0x25b) + E(0x1e9)), getQuotedForMessageId_1 = __importDefault(require(F(0x22c) + E(0x1e8) + F(0x21f) + E(0x245))), writeFileAsync = (-0x20 * -0x66 + -0x83f * -0x4 + -0x2 * 0x16de, util_1[F(0x207)])(fs_1[E(0x1f5)]), getMediaInfo = j => {
        const H = F, I = F, k = {};
        k[H(0x20a)] = H(0x231), k[I(0x1f9)] = H(0x1ed), k[I(0x21b)] = I(0x210), k[H(0x237)] = I(0x25d), k[I(0x249)] = H(0x238), k[I(0x258)] = I(0x23c), k[I(0x216)] = function (w, z) {
            return w - z;
        }, k[H(0x20d)] = function (w, z) {
            return w == z;
        }, k[H(0x1e7)] = I(0x1ef), k[H(0x236)] = H(0x232);
        const l = k, m = j[H(0x231)] ? l[H(0x20a)] : j[H(0x1ed)] ? l[I(0x1f9)] : j[H(0x210)] ? l[H(0x21b)] : j[I(0x25d)] ? l[H(0x237)] : j[I(0x238)] && !j[H(0x238)][H(0x1f6) + 'd'] ? l[I(0x249)] : l[I(0x258)], n = j[m], [o, p, q, r, s, t, v] = [
                m,
                n[H(0x21a)] ? n[I(0x21a)] : '',
                ![],
                null,
                n[I(0x1fd)] ? n[I(0x1fd)] : n[l[I(0x216)](n[H(0x251)], 0x92e * -0x1 + -0x25e3 + 0x2f12)][I(0x1fd)],
                j[I(0x1e5)] ? j[H(0x1e5)] : '',
                l[H(0x20d)](m, l[H(0x237)])
            ];
        switch (m) {
        case l[I(0x20a)]:
            const w = {};
            w[H(0x218)] = o, w[H(0x1ff)] = l[H(0x1e7)], w[I(0x20b)] = q, w[H(0x217)] = r, w[H(0x202)] = s, w[I(0x1e5)] = t, w[H(0x229)] = v;
            return w;
            break;
        case l[I(0x1f9)]:
            const x = {};
            x[H(0x218)] = o, x[I(0x1ff)] = p, x[I(0x20b)] = q, x[H(0x217)] = r, x[I(0x202)] = s, x[H(0x1e5)] = t, x[I(0x229)] = v;
            return x;
            break;
        case l[H(0x21b)]:
            const y = {};
            y[H(0x218)] = o, y[H(0x1ff)] = p, y[I(0x20b)] = q, y[I(0x217)] = r, y[H(0x202)] = s, y[I(0x1e5)] = t, y[I(0x229)] = v;
            return y;
            break;
        case l[I(0x237)]:
            const z = {};
            z[I(0x218)] = o, z[I(0x1ff)] = p, z[I(0x20b)] = q, z[H(0x217)] = r, z[I(0x202)] = s, z[H(0x1e5)] = t, z[H(0x229)] = v;
            return z;
            break;
        case l[H(0x249)]:
            const A = {};
            A[I(0x218)] = o, A[H(0x1ff)] = l[H(0x236)], A[I(0x20b)] = q, A[H(0x217)] = r, A[I(0x202)] = s, A[H(0x1e5)] = t, A[H(0x229)] = v, A[H(0x22b)] = !![];
            return A;
            break;
        default:
            const B = {};
            B[H(0x218)] = o, B[H(0x1ff)] = p, B[H(0x20b)] = !![], B[H(0x217)] = n[H(0x24c)] ? n[I(0x24c)] : null, B[H(0x202)] = s, B[H(0x1e5)] = t, B[H(0x229)] = v;
            return B;
            break;
        }
    }, downloadFile = async (c, d) => {
        const J = F, K = E, e = {
                'wEQtn': J(0x23b) + K(0x1e2),
                'VAFbx': function (g, h) {
                    return g(h);
                },
                'zmUMm': function (g, h) {
                    return g === h;
                },
                'YCYDf': J(0x256),
                'AjJyO': function (g, h) {
                    return g(h);
                },
                'iLAKq': function (g, h) {
                    return g === h;
                },
                'XWeET': J(0x1e6),
                'gNZZb': K(0x1df),
                'xzRLV': J(0x1d5),
                'aNJuV': J(0x240),
                'ecaUT': J(0x25a)
            }, f = await (0x1 * 0x1657 + 0x9 + -0x1660, axios_1[K(0x21c)])({
                'url': c[K(0x250)](),
                'method': e[J(0x204)],
                'responseType': e[J(0x212)]
            });
        await new Promise((g, h) => {
            const L = J, M = K;
            if (e[L(0x241)](e[M(0x1d6)], e[L(0x1d6)]))
                f[L(0x226)][M(0x1d8)]((-0xb0d + 0x17c7 + 0x12 * -0xb5, fs_1[M(0x1ee) + M(0x208)])(d))['on'](e[L(0x1f0)], async () => g(!![]))['on'](e[M(0x1f3)], i => {
                    const N = M, P = M, j = {
                            'xgcYO': e[N(0x21d)],
                            'fnXCX': function (k, l) {
                                const O = N;
                                return e[O(0x24b)](k, l);
                            }
                        };
                    e[N(0x1d9)](e[N(0x20c)], e[P(0x20c)]) ? (console[N(0x1d5)](e[P(0x21d)], i), e[N(0x1fa)](h, new Error(i))) : (h[P(0x1d5)](j[P(0x1fb)], i), j[P(0x200)](j, new k(l)));
                });
            else {
                const j = {};
                return j[M(0x21c)] = j, g && h[L(0x1f1)] ? i : j;
            }
        });
    }, VerifyMediaMessage = async (d, e, f, g) => {
        const Q = F, R = E, h = {
                'itFPn': Q(0x23b) + Q(0x1e2),
                'eJZYp': function (v, w) {
                    return v(w);
                },
                'UcMGG': R(0x1df),
                'vnhzQ': R(0x1d5),
                'aSLMq': function (v, w) {
                    return v && w;
                },
                'YCXGj': function (v, w) {
                    return v === w;
                },
                'EXbOg': R(0x215),
                'oLTOu': Q(0x1f7),
                'PClEw': R(0x1d7),
                'hluFo': Q(0x23d),
                'ukOMM': function (v, w, x) {
                    return v(w, x);
                },
                'Lotyu': function (v, w) {
                    return v !== w;
                },
                'baOYr': R(0x209),
                'reJGq': Q(0x1ea),
                'OyFUm': function (v, w) {
                    return v * w;
                },
                'uMBxz': Q(0x1fe),
                'rcXGK': R(0x1fc),
                'AfkyM': function (v, w) {
                    return v || w;
                }
            };
        let i, j = {};
        i = d?.[R(0x255)], j = d?.[R(0x228)];
        if (h[R(0x233)](!i, j)) {
            if (h[Q(0x1dd)](h[Q(0x20f)], h[R(0x20f)]))
                i = j?.[R(0x205) + Q(0x220)];
            else {
                e[Q(0x252)][R(0x1d5)](Q(0x253) + R(0x243) + Q(0x1da) + f[R(0x222)]);
                return;
            }
        }
        const k = await h[R(0x219)](getMediaInfo, i), l = await d[Q(0x22d)][R(0x1db)](k[Q(0x202)]);
        if (!l) {
            if (h[Q(0x1dd)](h[R(0x224)], h[Q(0x213)]))
                e = f?.[R(0x205) + R(0x220)];
            else {
                logger_1[Q(0x252)][R(0x1d5)](R(0x253) + R(0x243) + Q(0x1da) + i[Q(0x222)]);
                return;
            }
        }
        const m = k[Q(0x1ff)][R(0x230)]('/')[0x111f + 0x2 * -0xc1d + 0x71c][R(0x230)](';')[-0x21da + -0x1553 + 0x19 * 0x235], n = l[R(0x1fd)] + '_' + new Date()[R(0x246)]() + '.' + m, o = (-0x1847 + -0x2668 + 0x9 * 0x6f7, path_1[Q(0x1e0)])(__dirname, '..', '..', '..', h[Q(0x1d3)], n), p = await d[Q(0x22d)][R(0x248) + 'k'](k[Q(0x202)]);
        await h[Q(0x1e4)](downloadFile, p, o);
        let q;
        if (i?.[R(0x22f) + R(0x23e)]?.[Q(0x222)]) {
            if (h[Q(0x214)](h[Q(0x223)], h[R(0x1eb)])) {
                const x = await (-0x166e + -0x1 * -0x172b + -0xbd, getQuotedForMessageId_1[R(0x21c)])(i[R(0x22f) + Q(0x23e)][Q(0x222)], f[Q(0x259)]);
                q = x?.['id'] || undefined;
            } else {
                const z = {
                    'ASvBd': h[R(0x1f4)],
                    'HWbuF': function (A, B) {
                        const S = Q;
                        return h[S(0x219)](A, B);
                    }
                };
                j[Q(0x226)][Q(0x1d8)]((-0x78b * 0x3 + 0x11c * 0x20 + 0xcdf * -0x1, k[Q(0x1ee) + Q(0x208)])(l))['on'](h[Q(0x20e)], async () => q(!![]))['on'](h[R(0x21e)], A => {
                    const T = Q, U = R;
                    q[T(0x1d5)](z[T(0x201)], A), z[T(0x23f)](r, new s(A));
                });
            }
        }
        const r = {
            'messageId': h[Q(0x219)](String, i?.[R(0x222)]),
            'ticketId': f['id'],
            'contactId': e ? undefined : g['id'],
            'body': i[R(0x225)] || i[R(0x1e5)] || n,
            'fromMe': e,
            'read': e,
            'mediaUrl': n,
            'mediaType': k[Q(0x1ff)][Q(0x230)]('/')[0xfde + 0x228b + -0x3269],
            'quotedMsgId': q,
            'timestamp': h[R(0x23a)](+i[Q(0x254)], 0x1 * 0x205f + 0x191b + -0x3592),
            'status': e ? h[R(0x22a)] : h[R(0x234)]
        };
        await f[R(0x228)]({
            'lastMessage': i[R(0x225)] || i[Q(0x1e5)] || n,
            'lastMessageAt': new Date()[Q(0x246)](),
            'answered': h[Q(0x257)](e, ![])
        });
        const s = {};
        s[R(0x203) + 'a'] = r, s[Q(0x259)] = f[Q(0x259)];
        const t = await (0x17bc + 0xa9c + -0x2258, CreateMessageService_1[R(0x21c)])(s);
        return t;
    };
exports[E(0x21c)] = VerifyMediaMessage;