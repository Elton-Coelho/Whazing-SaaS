'use strict';
const E = b, F = b;
(function (c, d) {
    const C = b, D = b, e = c();
    while (!![]) {
        try {
            const f = parseInt(C(0x253)) / (-0x1eef + -0xfdf + 0x2ecf) + parseInt(C(0x246)) / (-0x1a1f + 0xc78 + 0xda9) * (parseInt(D(0x24a)) / (-0x8bb + 0x1 * 0xe17 + 0x25 * -0x25)) + parseInt(C(0x249)) / (-0x4 * 0x95f + -0x3d * -0x52 + 0x2 * 0x8fb) * (parseInt(D(0x211)) / (0x37 * -0x83 + 0x1e * -0x79 + 0x5 * 0x878)) + parseInt(D(0x222)) / (-0x13e9 * -0x1 + -0x1af5 + -0x16a * -0x5) * (-parseInt(D(0x21d)) / (0xf4c + -0x79 * -0x29 + -0xa * 0x377)) + -parseInt(D(0x244)) / (0x23b + -0x1a9c + 0x1869 * 0x1) + parseInt(D(0x1e8)) / (-0x223 * -0x12 + -0x23b + -0x2432) + parseInt(D(0x20b)) / (-0xc8b * 0x1 + 0x5 * -0x101 + 0x119a) * (-parseInt(D(0x21a)) / (0xc0a * 0x1 + -0x1736 + 0xb37));
            if (f === d)
                break;
            else
                e['push'](e['shift']());
        } catch (g) {
            e['push'](e['shift']());
        }
    }
}(a, -0x15ad5 * -0x1 + -0x1 * -0x11c11f + -0xa31a9));
function b(c, d) {
    const e = a();
    return b = function (f, g) {
        f = f - (-0x3 * -0x370 + -0x157 * 0x17 + -0x1 * -0x1647);
        let h = e[f];
        return h;
    }, b(c, d);
}
function a() {
    const U = [
        'data',
        'aRKWl',
        'nGEpt',
        'IbOCI',
        '792765AaGmHY',
        'geService',
        'ERROR\x20DONW',
        'sage',
        'MuLOC',
        'essage',
        'ers/getQuo',
        'caption',
        '../Message',
        'fault',
        'ERR_DOWNLO',
        'edited_mes',
        'GsEiL',
        'qqjeT',
        'erty',
        'fciWS',
        'mVMiD',
        'bFXNr',
        'audio',
        'YuRPH',
        'default',
        'uubcm',
        'messageDat',
        'woetQ',
        'photo',
        'AD_MEDIA::',
        'fpius',
        'util',
        'writeFile',
        'length',
        'piKmA',
        'Pgztq',
        'PCDBP',
        'getFileLin',
        'LOAD',
        '5810mbaqRm',
        'CpWmJ',
        'createWrit',
        'axios',
        'fileId',
        'image/png',
        '20cUvHcb',
        'GRqHZ',
        'MqnsK',
        'OeAfs',
        'GiqKJ',
        'message_id',
        'mlRui',
        'pCiva',
        'YpEvj',
        '4895duGPxD',
        'NfQwD',
        'split',
        '7XLXjSe',
        'pEyoe',
        'uGmqB',
        '__esModule',
        'bwCao',
        '1922088EMEOYa',
        'GZcst',
        'document',
        'hwIkU',
        'update',
        'SAD',
        'reply_to_m',
        'message',
        'promisify',
        'XIIZR',
        'ljFUc',
        'dpXIP',
        'telegram',
        'join',
        'getFile',
        'wBQWa',
        'inrLx',
        'nuNXK',
        'date',
        'pipe',
        'reateMessa',
        'ocWEU',
        'getTime',
        'image/webp',
        'DInpj',
        'ZwaFO',
        'error',
        'toString',
        'eStream',
        'CJpYA',
        'value',
        'stream',
        'video',
        'rwxKc',
        '4202256GyRzcQ',
        'tenantId',
        '36guogwX',
        'psqAI',
        'text',
        '160652cyEIyg',
        '71583GcWcub',
        '\x20ID:\x20',
        'PNqyz',
        'mime_type',
        'EwOqF',
        'SAV',
        's/logger',
        'type',
        'sended',
        '1010207zkiUqo',
        'xBreY',
        'public',
        'file_name',
        'is_animate',
        'file_id',
        'mimeType',
        'fileName',
        'voice',
        '__importDe',
        'defineProp',
        'FlJhU',
        '../../help',
        'path',
        'zVuFM',
        'GET',
        'SAS',
        'Services/C',
        'ageId',
        'wYKrP',
        'logger',
        'uxTGl',
        'received',
        'finish',
        'xTWFR',
        '../../util',
        'bYxzF',
        'JDTIc',
        'sticker',
        'tedForMess',
        'pRiES'
    ];
    a = function () {
        return U;
    };
    return a();
}
var __importDefault = this && this[E(0x1ce) + F(0x1f1)] || function (c) {
    const G = E;
    return c && c[G(0x220)] ? c : { 'default': c };
};
const u = {};
u[F(0x240)] = !![], Object[E(0x1cf) + F(0x1f6)](exports, F(0x220), u);
const path_1 = require(F(0x1d2)), util_1 = require(E(0x203)), fs_1 = require('fs'), axios_1 = __importDefault(require(E(0x20e))), CreateMessageService_1 = __importDefault(require(F(0x1f0) + E(0x1d6) + E(0x236) + F(0x1e9))), logger_1 = require(F(0x1de) + F(0x250)), getQuotedForMessageId_1 = __importDefault(require(E(0x1d1) + F(0x1ee) + E(0x1e2) + E(0x1d7))), writeFileAsync = (-0x198f + 0x609 + 0x1386, util_1[F(0x22a)])(fs_1[F(0x204)]), getMediaInfo = j => {
        const H = F, I = F, k = {};
        k[H(0x1e6)] = H(0x200), k[I(0x1f7)] = I(0x242), k[H(0x21f)] = H(0x1fa), k[H(0x232)] = H(0x1cd), k[I(0x208)] = H(0x1e1), k[I(0x219)] = H(0x224), k[I(0x1d3)] = function (w, z) {
            return w - z;
        }, k[I(0x1da)] = function (w, z) {
            return w == z;
        }, k[H(0x1e7)] = H(0x210), k[H(0x1dd)] = H(0x239);
        const l = k, m = j[H(0x200)] ? l[I(0x1e6)] : j[H(0x242)] ? l[I(0x1f7)] : j[I(0x1fa)] ? l[H(0x21f)] : j[I(0x1cd)] ? l[H(0x232)] : j[I(0x1e1)] && !j[H(0x1e1)][I(0x1c9) + 'd'] ? l[I(0x208)] : l[I(0x219)], n = j[m], [o, p, q, r, s, t, v] = [
                m,
                n[H(0x24d)] ? n[H(0x24d)] : '',
                ![],
                null,
                n[H(0x1ca)] ? n[I(0x1ca)] : n[l[H(0x1d3)](n[I(0x205)], -0x19 * -0x12f + 0xd3c + -0x261 * 0x12)][I(0x1ca)],
                j[I(0x1ef)] ? j[I(0x1ef)] : '',
                l[H(0x1da)](m, l[I(0x232)])
            ];
        switch (m) {
        case l[H(0x1e6)]:
            const w = {};
            w[I(0x251)] = o, w[I(0x1cb)] = l[H(0x1e7)], w[H(0x227)] = q, w[I(0x1cc)] = r, w[I(0x20f)] = s, w[H(0x1ef)] = t, w[I(0x24f)] = v;
            return w;
            break;
        case l[I(0x1f7)]:
            const x = {};
            x[H(0x251)] = o, x[I(0x1cb)] = p, x[I(0x227)] = q, x[I(0x1cc)] = r, x[I(0x20f)] = s, x[I(0x1ef)] = t, x[H(0x24f)] = v;
            return x;
            break;
        case l[I(0x21f)]:
            const y = {};
            y[I(0x251)] = o, y[I(0x1cb)] = p, y[I(0x227)] = q, y[H(0x1cc)] = r, y[H(0x20f)] = s, y[I(0x1ef)] = t, y[H(0x24f)] = v;
            return y;
            break;
        case l[H(0x232)]:
            const z = {};
            z[H(0x251)] = o, z[H(0x1cb)] = p, z[H(0x227)] = q, z[H(0x1cc)] = r, z[H(0x20f)] = s, z[I(0x1ef)] = t, z[I(0x24f)] = v;
            return z;
            break;
        case l[H(0x208)]:
            const A = {};
            A[I(0x251)] = o, A[H(0x1cb)] = l[H(0x1dd)], A[H(0x227)] = q, A[I(0x1cc)] = r, A[H(0x20f)] = s, A[I(0x1ef)] = t, A[H(0x24f)] = v, A[I(0x1d5)] = !![];
            return A;
            break;
        default:
            const B = {};
            B[H(0x251)] = o, B[I(0x1cb)] = p, B[I(0x227)] = !![], B[I(0x1cc)] = n[I(0x1c8)] ? n[I(0x1c8)] : null, B[H(0x20f)] = s, B[I(0x1ef)] = t, B[I(0x24f)] = v;
            return B;
            break;
        }
    }, downloadFile = async (c, d) => {
        const J = F, K = F, e = {
                'OeAfs': function (g, h) {
                    return g === h;
                },
                'pEyoe': J(0x1f8),
                'NfQwD': J(0x1fd),
                'bFXNr': J(0x1ea) + K(0x20a),
                'dpXIP': function (g, h) {
                    return g(h);
                },
                'EwOqF': function (g, h) {
                    return g !== h;
                },
                'GRqHZ': J(0x221),
                'CpWmJ': K(0x1ec),
                'FlJhU': K(0x1dc),
                'GZcst': K(0x23c),
                'qqjeT': J(0x1d4),
                'ocWEU': J(0x241)
            }, f = await (-0x6f9 * 0x1 + 0x343 * 0x2 + -0x1 * -0x73, axios_1[K(0x1fc)])({
                'url': c[J(0x23d)](),
                'method': e[K(0x1f5)],
                'responseType': e[K(0x237)]
            });
        await new Promise((g, h) => {
            const L = K, M = J;
            if (e[L(0x24e)](e[L(0x212)], e[L(0x20c)]))
                f[M(0x1e4)][M(0x235)]((-0x1a65 * -0x1 + 0x6 * -0x436 + -0x121 * 0x1, fs_1[M(0x20d) + M(0x23e)])(d))['on'](e[L(0x1d0)], async () => g(!![]))['on'](e[L(0x223)], i => {
                    const N = M, O = L;
                    e[N(0x214)](e[O(0x21e)], e[N(0x21b)]) ? e = f?.[O(0x1f3) + N(0x1eb)] : (console[O(0x23c)](e[O(0x1f9)], i), e[O(0x22d)](h, new Error(i)));
                });
            else {
                e[L(0x1d9)][L(0x23c)](M(0x1f2) + L(0x201) + M(0x24b) + f[L(0x216)]);
                return;
            }
        });
    }, VerifyMediaMessage = async (d, e, f, g) => {
        const P = E, Q = F, h = {
                'DInpj': P(0x1ea) + Q(0x20a),
                'MqnsK': function (v, w) {
                    return v(w);
                },
                'PNqyz': Q(0x1dc),
                'xBreY': P(0x23c),
                'fpius': function (v, w) {
                    return v(w);
                },
                'JDTIc': function (v, w) {
                    return v && w;
                },
                'GsEiL': function (v, w) {
                    return v !== w;
                },
                'bYxzF': P(0x231),
                'ljFUc': P(0x247),
                'Pgztq': function (v, w) {
                    return v === w;
                },
                'piKmA': Q(0x1e3),
                'mlRui': P(0x1c7),
                'aRKWl': function (v, w, x) {
                    return v(w, x);
                },
                'GiqKJ': P(0x243),
                'XIIZR': P(0x1fb),
                'wYKrP': function (v, w) {
                    return v(w);
                },
                'nuNXK': function (v, w) {
                    return v * w;
                },
                'pCiva': Q(0x252),
                'ZwaFO': Q(0x1db),
                'hwIkU': function (v, w) {
                    return v || w;
                }
            };
        let i, j = {};
        i = d?.[P(0x229)], j = d?.[P(0x226)];
        if (h[P(0x1e0)](!i, j)) {
            if (h[Q(0x1f4)](h[P(0x1df)], h[P(0x22c)]))
                i = j?.[P(0x1f3) + P(0x1eb)];
            else {
                const w = {
                    'woetQ': h[P(0x23a)],
                    'CJpYA': function (x, y) {
                        const R = Q;
                        return h[R(0x213)](x, y);
                    }
                };
                j[P(0x1e4)][P(0x235)]((-0x1340 + -0x13 * -0x9f + -0x773 * -0x1, k[Q(0x20d) + P(0x23e)])(l))['on'](h[Q(0x24c)], async () => q(!![]))['on'](h[P(0x1c6)], x => {
                    const S = P, T = Q;
                    q[S(0x23c)](w[T(0x1ff)], x), w[S(0x23f)](r, new s(x));
                });
            }
        }
        const k = await h[Q(0x202)](getMediaInfo, i), l = await d[P(0x22e)][Q(0x230)](k[Q(0x20f)]);
        if (!l) {
            if (h[Q(0x207)](h[P(0x206)], h[Q(0x206)])) {
                logger_1[P(0x1d9)][Q(0x23c)](P(0x1f2) + P(0x201) + Q(0x24b) + i[Q(0x216)]);
                return;
            } else {
                const x = {};
                return x[P(0x1fc)] = j, g && h[Q(0x220)] ? i : x;
            }
        }
        const m = k[Q(0x1cb)][Q(0x21c)]('/')[-0x22d6 + 0x1335 + 0xfa2][P(0x21c)](';')[-0x688 + -0x203f + 0x3 * 0xced], n = l[Q(0x1ca)] + '_' + new Date()[P(0x238)]() + '.' + m, o = (-0x1 * -0x146f + 0xf93 + -0x2402, path_1[P(0x22f)])(__dirname, '..', '..', '..', h[P(0x217)], n), p = await d[Q(0x22e)][P(0x209) + 'k'](k[Q(0x20f)]);
        await h[P(0x1e5)](downloadFile, p, o);
        let q;
        if (i?.[P(0x228) + P(0x1ed)]?.[P(0x216)]) {
            if (h[Q(0x1f4)](h[Q(0x215)], h[Q(0x22b)])) {
                const x = await (0x214e + -0x541 + -0x1 * 0x1c0d, getQuotedForMessageId_1[P(0x1fc)])(i[Q(0x228) + Q(0x1ed)][P(0x216)], f[Q(0x245)]);
                q = x?.['id'] || undefined;
            } else
                h[Q(0x23c)](h[P(0x23a)], i), h[P(0x202)](j, new k(l));
        }
        const r = {
            'messageId': h[P(0x1d8)](String, i?.[Q(0x216)]),
            'ticketId': f['id'],
            'contactId': e ? undefined : g['id'],
            'body': i[P(0x248)] || i[Q(0x1ef)] || n,
            'fromMe': e,
            'read': e,
            'mediaUrl': n,
            'mediaType': k[Q(0x1cb)][Q(0x21c)]('/')[0x12 * 0x6b + 0x4 * -0x3a7 + 0x716],
            'quotedMsgId': q,
            'timestamp': h[P(0x233)](+i[Q(0x234)], -0x2 * -0xc2d + -0x193c + 0x4ca * 0x1),
            'status': e ? h[Q(0x218)] : h[Q(0x23b)]
        };
        await f[Q(0x226)]({
            'lastMessage': i[P(0x248)] || i[Q(0x1ef)] || n,
            'lastMessageAt': new Date()[Q(0x238)](),
            'answered': h[P(0x225)](e, ![])
        });
        const s = {};
        s[P(0x1fe) + 'a'] = r, s[P(0x245)] = f[P(0x245)];
        const t = await (-0x18ba + 0x291 * -0xc + 0x3786, CreateMessageService_1[Q(0x1fc)])(s);
        return t;
    };
exports[F(0x1fc)] = VerifyMediaMessage;