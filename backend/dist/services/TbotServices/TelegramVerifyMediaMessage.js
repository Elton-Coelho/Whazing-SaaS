'use strict';
const E = b, F = b;
function a() {
    const U = [
        'finish',
        'value',
        'SAD',
        'document',
        '4sVjQcX',
        'ZBBGn',
        'stream',
        'AD_MEDIA::',
        'defineProp',
        'sended',
        'lItQo',
        'YMeWk',
        'is_animate',
        'axios',
        'geService',
        'split',
        'image/webp',
        'message',
        'MnwlM',
        'ocmYA',
        'toString',
        'mqnis',
        'erty',
        'LOAD',
        'createWrit',
        'fileName',
        'gtEmt',
        'GET',
        'logger',
        'getFile',
        '../../util',
        'util',
        'NyDft',
        'sticker',
        'promisify',
        'mime_type',
        '1370608FGYfrH',
        '../../help',
        'date',
        'GnorG',
        'audio',
        'mimeType',
        'FFPLL',
        'SAV',
        'TkuOV',
        'path',
        'default',
        'type',
        'data',
        '237552UELvuJ',
        'aCSlt',
        'NnyBr',
        'QgaOB',
        'uVTif',
        'KAteB',
        'video',
        'reateMessa',
        'GjxLt',
        'AfQTW',
        'jWpdB',
        'image/png',
        '186008TNogXU',
        '__esModule',
        's/logger',
        'error',
        'fault',
        'reply_to_m',
        'KgXlp',
        'join',
        'PIWgv',
        '__importDe',
        'ageId',
        'pipe',
        'text',
        'EpxEZ',
        'MCBrs',
        'received',
        'oPfNS',
        'MGEbx',
        'rQiWj',
        'getFileLin',
        'VNAUx',
        '2881465RCncEP',
        'sage',
        'update',
        'afPLw',
        'yTNeI',
        'cTRDE',
        'MNufJ',
        '138201RtAseo',
        'photo',
        'tedForMess',
        'getTime',
        'messageDat',
        'kqRWL',
        'IiLNI',
        'BgrNr',
        '../Message',
        'KNSjd',
        'public',
        'lHCtG',
        'ERR_DOWNLO',
        'eNjGJ',
        '\x20ID:\x20',
        'NyuTV',
        'file_id',
        'file_name',
        'tdSuS',
        'vlXEK',
        'TEJRi',
        'fileId',
        'EMiZz',
        'uVwWz',
        'WKwXJ',
        'TFTfZ',
        'ERROR\x20DONW',
        'ers/getQuo',
        'SAS',
        'essage',
        '282kBnoVg',
        'tenantId',
        'eStream',
        'EFXgQ',
        'length',
        'edited_mes',
        'ijMwh',
        'yeQQX',
        '11633544qDDdBR',
        'message_id',
        'AlffP',
        'telegram',
        'writeFile',
        'Services/C',
        'voice',
        'caption',
        '1855200BKeUFD'
    ];
    a = function () {
        return U;
    };
    return a();
}
(function (c, d) {
    const C = b, D = b, e = c();
    while (!![]) {
        try {
            const f = parseInt(C(0x1ec)) / (-0x4d5 * 0x1 + 0x1 * -0x1349 + 0x181f) + parseInt(D(0x1d3)) / (-0x1 * 0x26c9 + -0x1420 + 0x3aeb) + parseInt(D(0x1ae)) / (0x1 * -0x35f + -0x1371 * -0x1 + -0x100f) + -parseInt(D(0x1b3)) / (-0x1 * -0x23b1 + 0xabb + -0x2e68) * (parseInt(D(0x201)) / (-0x14c + -0x1 * -0x1d5f + 0x7e * -0x39)) + -parseInt(D(0x226)) / (-0x7 * 0x13d + -0x34 * 0x42 + 0x1619) * (-parseInt(C(0x208)) / (-0x1455 * -0x1 + -0x2 * -0xd49 + 0x2ee0 * -0x1)) + -parseInt(C(0x1e0)) / (-0xa * 0x37e + 0xa76 + -0x5 * -0x4e6) + -parseInt(C(0x22e)) / (-0x6e3 + 0x1 * -0x1eef + 0x25db);
            if (f === d)
                break;
            else
                e['push'](e['shift']());
        } catch (g) {
            e['push'](e['shift']());
        }
    }
}(a, -0x327d6 + -0x5b50a + -0x2 * -0x8642b));
var __importDefault = this && this[E(0x1f5) + E(0x1f0)] || function (c) {
    const G = F;
    return c && c[G(0x1ed)] ? c : { 'default': c };
};
const u = {};
u[E(0x1b0)] = !![], Object[F(0x1b7) + E(0x1c5)](exports, E(0x1ed), u);
const path_1 = require(F(0x1dc)), util_1 = require(E(0x1ce)), fs_1 = require('fs'), axios_1 = __importDefault(require(E(0x1bc))), CreateMessageService_1 = __importDefault(require(E(0x210) + F(0x1ab) + E(0x1e7) + E(0x1bd))), logger_1 = require(F(0x1cd) + E(0x1ee)), getQuotedForMessageId_1 = __importDefault(require(E(0x1d4) + E(0x223) + F(0x20a) + E(0x1f6))), writeFileAsync = (-0x184f + -0xa7b + 0x22ca, util_1[E(0x1d1)])(fs_1[F(0x1aa)]), getMediaInfo = j => {
        const H = F, I = F, k = {};
        k[H(0x1fe)] = I(0x209), k[H(0x1c9)] = I(0x1e6), k[I(0x217)] = H(0x1d7), k[I(0x1c2)] = I(0x1ac), k[H(0x1fa)] = H(0x1d0), k[H(0x1ba)] = H(0x1b2), k[I(0x20e)] = function (w, z) {
            return w - z;
        }, k[H(0x204)] = function (w, z) {
            return w == z;
        }, k[H(0x1e3)] = H(0x1eb), k[H(0x1b9)] = H(0x1bf);
        const l = k, m = j[I(0x209)] ? l[H(0x1fe)] : j[I(0x1e6)] ? l[H(0x1c9)] : j[H(0x1d7)] ? l[I(0x217)] : j[I(0x1ac)] ? l[I(0x1c2)] : j[H(0x1d0)] && !j[H(0x1d0)][I(0x1bb) + 'd'] ? l[I(0x1fa)] : l[H(0x1ba)], n = j[m], [o, p, q, r, s, t, v] = [
                m,
                n[I(0x1d2)] ? n[H(0x1d2)] : '',
                ![],
                null,
                n[H(0x218)] ? n[I(0x218)] : n[l[H(0x20e)](n[I(0x22a)], 0x1ea7 + 0x995 + -0x283b * 0x1)][I(0x218)],
                j[I(0x1ad)] ? j[I(0x1ad)] : '',
                l[I(0x204)](m, l[I(0x1c2)])
            ];
        switch (m) {
        case l[H(0x1fe)]:
            const w = {};
            w[I(0x1de)] = o, w[H(0x1d8)] = l[I(0x1e3)], w[I(0x1b1)] = q, w[H(0x1c8)] = r, w[I(0x21d)] = s, w[I(0x1ad)] = t, w[H(0x1da)] = v;
            return w;
            break;
        case l[H(0x1c9)]:
            const x = {};
            x[H(0x1de)] = o, x[H(0x1d8)] = p, x[H(0x1b1)] = q, x[H(0x1c8)] = r, x[I(0x21d)] = s, x[I(0x1ad)] = t, x[I(0x1da)] = v;
            return x;
            break;
        case l[H(0x217)]:
            const y = {};
            y[H(0x1de)] = o, y[H(0x1d8)] = p, y[I(0x1b1)] = q, y[H(0x1c8)] = r, y[I(0x21d)] = s, y[I(0x1ad)] = t, y[H(0x1da)] = v;
            return y;
            break;
        case l[I(0x1c2)]:
            const z = {};
            z[H(0x1de)] = o, z[H(0x1d8)] = p, z[I(0x1b1)] = q, z[H(0x1c8)] = r, z[H(0x21d)] = s, z[I(0x1ad)] = t, z[I(0x1da)] = v;
            return z;
            break;
        case l[H(0x1fa)]:
            const A = {};
            A[H(0x1de)] = o, A[I(0x1d8)] = l[H(0x1b9)], A[H(0x1b1)] = q, A[I(0x1c8)] = r, A[H(0x21d)] = s, A[H(0x1ad)] = t, A[I(0x1da)] = v, A[I(0x224)] = !![];
            return A;
            break;
        default:
            const B = {};
            B[H(0x1de)] = o, B[I(0x1d8)] = p, B[I(0x1b1)] = !![], B[H(0x1c8)] = n[H(0x219)] ? n[I(0x219)] : null, B[H(0x21d)] = s, B[I(0x1ad)] = t, B[I(0x1da)] = v;
            return B;
            break;
        }
    }, downloadFile = async (c, d) => {
        const J = F, K = F, e = {
                'uVTif': function (g, h) {
                    return g !== h;
                },
                'NnyBr': J(0x207),
                'oPfNS': K(0x1c1),
                'KNSjd': J(0x222) + J(0x1c6),
                'mqnis': function (g, h) {
                    return g(h);
                },
                'EFXgQ': function (g, h) {
                    return g === h;
                },
                'TEJRi': K(0x1d9),
                'TFTfZ': K(0x22c),
                'tdSuS': K(0x1af),
                'uVwWz': J(0x1ef),
                'cTRDE': J(0x1ca),
                'EpxEZ': J(0x1b5)
            }, f = await (0x1 * -0x817 + -0x1d51 + -0x9 * -0x428, axios_1[K(0x1dd)])({
                'url': c[K(0x1c3)](),
                'method': e[J(0x206)],
                'responseType': e[J(0x1f9)]
            });
        await new Promise((g, h) => {
            const L = J, M = J;
            if (e[L(0x229)](e[M(0x21c)], e[M(0x221)])) {
                e[L(0x1cb)][L(0x1ef)](M(0x214) + L(0x1b6) + M(0x216) + f[M(0x1a7)]);
                return;
            } else
                f[L(0x1df)][M(0x1f7)]((0xc5 + -0x10b1 * -0x1 + -0x1176, fs_1[M(0x1c7) + M(0x228)])(d))['on'](e[L(0x21a)], async () => g(!![]))['on'](e[M(0x21f)], j => {
                    const N = L, O = L;
                    e[N(0x1e4)](e[O(0x1e2)], e[O(0x1fc)]) ? (console[N(0x1ef)](e[O(0x211)], j), e[O(0x1c4)](h, new Error(j))) : e = f?.[N(0x22b) + O(0x202)];
                });
        });
    }, VerifyMediaMessage = async (d, e, f, g) => {
        const P = F, Q = E, h = {
                'NyDft': P(0x222) + Q(0x1c6),
                'MGEbx': function (v, w) {
                    return v(w);
                },
                'AfQTW': Q(0x1af),
                'AlffP': Q(0x1ef),
                'yTNeI': function (v, w) {
                    return v && w;
                },
                'BgrNr': function (v, w) {
                    return v !== w;
                },
                'kqRWL': P(0x1db),
                'jWpdB': function (v, w) {
                    return v(w);
                },
                'aCSlt': function (v, w) {
                    return v === w;
                },
                'vlXEK': P(0x1e5),
                'EMiZz': Q(0x212),
                'WKwXJ': function (v, w, x) {
                    return v(w, x);
                },
                'KgXlp': P(0x200),
                'PIWgv': function (v, w) {
                    return v(w);
                },
                'GnorG': function (v, w) {
                    return v * w;
                },
                'eNjGJ': P(0x1b8),
                'yeQQX': P(0x1fb),
                'ZBBGn': function (v, w) {
                    return v || w;
                }
            };
        let i, j = {};
        i = d?.[P(0x1c0)], j = d?.[P(0x203)];
        if (h[Q(0x205)](!i, j)) {
            if (h[Q(0x20f)](h[Q(0x20d)], h[P(0x20d)])) {
                const w = {
                    'lHCtG': h[Q(0x1cf)],
                    'GjxLt': function (x, y) {
                        const R = P;
                        return h[R(0x1fd)](x, y);
                    }
                };
                j[Q(0x1df)][P(0x1f7)]((0x757 * 0x4 + -0x22af * 0x1 + -0x2f * -0x1d, k[P(0x1c7) + Q(0x228)])(l))['on'](h[Q(0x1e9)], async () => q(!![]))['on'](h[P(0x1a8)], x => {
                    const S = P, T = P;
                    q[S(0x1ef)](w[T(0x213)], x), w[T(0x1e8)](r, new s(x));
                });
            } else
                i = j?.[Q(0x22b) + Q(0x202)];
        }
        const k = await h[Q(0x1ea)](getMediaInfo, i), l = await d[Q(0x1a9)][Q(0x1cc)](k[Q(0x21d)]);
        if (!l) {
            if (h[P(0x1e1)](h[Q(0x21b)], h[P(0x21b)])) {
                logger_1[P(0x1cb)][P(0x1ef)](Q(0x214) + P(0x1b6) + Q(0x216) + i[P(0x1a7)]);
                return;
            } else
                h[Q(0x1ef)](h[Q(0x1cf)], i), h[Q(0x1fd)](j, new k(l));
        }
        const m = k[Q(0x1d8)][P(0x1be)]('/')[-0x5f + 0x4 * -0x48f + -0x129c * -0x1][Q(0x1be)](';')[0xa * 0x2dd + 0x598 * -0x2 + -0x1172], n = l[Q(0x218)] + '_' + new Date()[Q(0x20b)]() + '.' + m, o = (-0x1cdc + 0x2d3 + 0x1a09, path_1[Q(0x1f3)])(__dirname, '..', '..', '..', h[P(0x21e)], n), p = await d[P(0x1a9)][P(0x1ff) + 'k'](k[Q(0x21d)]);
        await h[P(0x220)](downloadFile, p, o);
        let q;
        if (i?.[Q(0x1f1) + P(0x225)]?.[Q(0x1a7)]) {
            if (h[P(0x1e1)](h[P(0x1f2)], h[P(0x1f2)])) {
                const x = await (0x1171 * -0x2 + -0x20f8 + 0x5a * 0xc1, getQuotedForMessageId_1[P(0x1dd)])(i[Q(0x1f1) + Q(0x225)][P(0x1a7)], f[Q(0x227)]);
                q = x?.['id'] || undefined;
            } else {
                const z = {};
                return z[P(0x1dd)] = j, g && h[Q(0x1ed)] ? i : z;
            }
        }
        const r = {
            'messageId': h[Q(0x1f4)](String, i?.[P(0x1a7)]),
            'ticketId': f['id'],
            'contactId': e ? undefined : g['id'],
            'body': i[Q(0x1f8)] || i[Q(0x1ad)] || n,
            'fromMe': e,
            'read': e,
            'mediaUrl': n,
            'mediaType': k[Q(0x1d8)][Q(0x1be)]('/')[0x11d6 + -0x26e9 + 0x41 * 0x53],
            'quotedMsgId': q,
            'timestamp': h[Q(0x1d6)](+i[P(0x1d5)], 0x1 * -0xf87 + 0x4 * 0x1a5 + 0xcdb),
            'status': e ? h[P(0x215)] : h[Q(0x22d)]
        };
        await f[Q(0x203)]({
            'lastMessage': i[Q(0x1f8)] || i[P(0x1ad)] || n,
            'lastMessageAt': new Date()[Q(0x20b)](),
            'answered': h[P(0x1b4)](e, ![])
        });
        const s = {};
        s[P(0x20c) + 'a'] = r, s[P(0x227)] = f[P(0x227)];
        const t = await (0x185 * 0x2 + 0xf3a + -0x1244, CreateMessageService_1[P(0x1dd)])(s);
        return t;
    };
function b(c, d) {
    const e = a();
    return b = function (f, g) {
        f = f - (0x85d * -0x1 + 0x1ed5 + -0x14d1 * 0x1);
        let h = e[f];
        return h;
    }, b(c, d);
}
exports[E(0x1dd)] = VerifyMediaMessage;