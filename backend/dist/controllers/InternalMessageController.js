'use strict';
const a2 = b, a3 = b;
(function (c, d) {
    const a0 = b, a1 = b, e = c();
    while (!![]) {
        try {
            const f = -parseInt(a0(0xed)) / (0x7d * -0xb + -0xdc + -0x3 * -0x214) * (parseInt(a1(0x7e)) / (-0x1274 + 0x2 * 0x12c1 + -0x130c)) + -parseInt(a1(0xee)) / (-0x1 * 0x16db + 0x2522 + 0x14c * -0xb) + parseInt(a1(0x92)) / (0x29a + 0x28a * 0x1 + -0x520) * (-parseInt(a0(0x89)) / (0x2 * 0xb8f + -0x19b * -0x1 + -0x18b4)) + parseInt(a1(0xe4)) / (-0x1ae7 + 0x184b + 0x2a2) + parseInt(a1(0x129)) / (-0x1 * -0x2261 + 0xe4 * 0x29 + -0x46de) * (-parseInt(a0(0xce)) / (0x3f + 0x1 * -0x194c + 0x1 * 0x1915)) + -parseInt(a0(0x121)) / (0x12f6 + 0xa51 * 0x1 + -0x1d3e) * (parseInt(a0(0xc1)) / (0x37 * -0x10 + 0x1d50 + -0x19d6)) + parseInt(a0(0xaa)) / (0x251c + 0xd9c + -0x32ad * 0x1) * (parseInt(a1(0x10c)) / (-0x1e8 + -0x374 + -0x15a * -0x4));
            if (f === d)
                break;
            else
                e['push'](e['shift']());
        } catch (g) {
            e['push'](e['shift']());
        }
    }
}(a, 0x2 * -0x6a3df + 0x96f7a * -0x1 + 0x1d86a1));
var __importDefault = this && this[a2(0x90) + a2(0x113)] || function (c) {
    const a4 = a2;
    return c && c[a4(0x115)] ? c : { 'default': c };
};
const o = {};
o[a3(0x112)] = !![], Object[a3(0xab) + a3(0x102)](exports, a2(0x115), o), exports[a3(0xb1) + a2(0x88) + 'ge'] = exports[a2(0xd5) + a2(0xe6) + 'a'] = exports[a3(0xd6) + a3(0x9e)] = exports[a2(0xd4) + a2(0x125)] = void (-0x2010 + 0x7a5 + 0x186b);
function b(c, d) {
    const e = a();
    return b = function (f, g) {
        f = f - (0x726 * -0x5 + 0x22f4 + -0x1 * -0x145);
        let h = e[f];
        return h;
    }, b(c, d);
}
const socket_1 = require(a3(0x10d) + a2(0x11e)), InternalMessage_1 = __importDefault(require(a2(0x128) + a2(0xfa) + a2(0xe3))), User_1 = __importDefault(require(a3(0x128) + a2(0xe9))), ListCountUnreadMessage_1 = __importDefault(require(a3(0x8b) + a2(0x101) + a2(0x84) + a3(0x9b) + a3(0x97))), MessageService_1 = __importDefault(require(a2(0x8b) + a2(0x101) + a3(0x118) + a2(0x83) + 'ce')), ReadMessageService_1 = __importDefault(require(a2(0x8b) + a3(0x101) + a2(0x7f) + a2(0x12a) + a2(0xe0))), logger_1 = require(a3(0x11f) + a2(0xac)), listarMensagens = async (f, g) => {
        const a5 = a3, a6 = a3, h = {};
        h[a5(0x87)] = a5(0x9f) + a6(0xc0) + a6(0xa9), h[a6(0xa5)] = function (j, k) {
            return j !== k;
        }, h[a6(0x120)] = a5(0x119), h[a6(0x82)] = a5(0x114), h[a6(0xad)] = a5(0xc8) + a6(0xc2) + a6(0x91) + a6(0x85);
        const i = h;
        try {
            if (i[a5(0xa5)](i[a6(0x120)], i[a6(0x120)]))
                throw new d(i[a6(0x87)]);
            else {
                const {id: k} = f[a5(0xca)], {userId: l} = f[a6(0x7d)], {isGroup: m} = f[a5(0x98)], n = await MessageService_1[a5(0x7b)][a6(0xd4) + a6(0x125)](k, l, m), p = {};
                return p[a5(0x122)] = n, g[a6(0x11b)](-0x1ac7 + 0x16bb * 0x1 + 0x3 * 0x19c)[a5(0x10f)](p);
            }
        } catch (q) {
            if (i[a6(0xa5)](i[a6(0x82)], i[a6(0x82)])) {
                const s = {};
                return s[a6(0x7b)] = j, g && h[a6(0x115)] ? i : s;
            } else {
                console[a6(0xe5)](q);
                const s = {};
                return s[a5(0xe5)] = i[a6(0xad)], g[a6(0x11b)](-0x15d * -0x15 + -0x17b + 0x2b * -0x96)[a5(0x10f)](s);
            }
        }
    };
exports[a2(0xd4) + a3(0x125)] = listarMensagens;
function a() {
    const af = [
        'Ã£o\x20lidas.',
        'action',
        'mediaName',
        'listarMens',
        'marcarMens',
        'criarMensa',
        'eGBSd',
        'nsagem-cha',
        'viqFt',
        'getIO',
        'chat-inter',
        '\x20erro\x20ao\x20c',
        'model',
        'ruEYz',
        'emit',
        'ervice',
        'pPNTF',
        'sKjLV',
        'ssage',
        '3291738CLjanm',
        'error',
        'agemNaoLid',
        'chat',
        'data',
        'User',
        'sender',
        'filename',
        'marcadas\x20c',
        '1aQQzHU',
        '1839513tAHSKv',
        'jKEyZ',
        'wfBAJ',
        'dWRxX',
        'ZUxGH',
        'userId',
        'OKrsi',
        'sagem.',
        'name',
        'logger',
        'prtsb',
        'substr',
        'InternalMe',
        'riar\x20a\x20men',
        'tMKXO',
        'ontar\x20as\x20m',
        'FtdwL',
        'mensagem',
        'nInSb',
        's/Internal',
        'erty',
        'uTVyk',
        'sdnni',
        'split',
        'Mensagems\x20',
        'originalna',
        'findOne',
        'RZCFI',
        'bVVqW',
        '\x20erro\x20ao\x20m',
        '24MSIjOn',
        '../libs/so',
        'attributes',
        'json',
        'JMuwX',
        'sqRTE',
        'value',
        'fault',
        'KaGbK',
        '__esModule',
        'nBNAA',
        'neaee',
        'Message/Me',
        'XWsxA',
        'zQtFQ',
        'status',
        'files',
        'getTime',
        'cket',
        '../utils/l',
        'MpQCY',
        '1746243BiFzQx',
        'mensagens',
        'PzTJL',
        'count',
        'agens',
        'where',
        'receiver',
        '../models/',
        '239918gtsAlz',
        'adMessageS',
        'IzQTv',
        'FpxEk',
        'text',
        'update',
        'default',
        'mimetype',
        'params',
        '1616376uRKuZr',
        'Message/Re',
        'mGbOz',
        'include',
        'xUaSf',
        'ssageServi',
        'Message/Li',
        'ensagens.',
        'arcar\x20a\x20me',
        'fJsJa',
        'nreadMessa',
        '95XOuliI',
        'mediaUrl',
        '../service',
        'pCVrK',
        't-interno',
        'receiverId',
        'yRwdw',
        '__importDe',
        'istar\x20as\x20m',
        '78280uZdzZR',
        'IZEEf',
        'gpQst',
        'KWqaN',
        ':unread-me',
        'eadMessage',
        'query',
        'isGroup',
        'body',
        'stCountUnr',
        'KNntr',
        'WUWkA',
        'gem',
        'ERR_CREATI',
        'length',
        'map',
        'groupId',
        'sGQQX',
        'no-notific',
        'TkPno',
        'wKVVN',
        'CwQRO',
        'lxrAA',
        '_SYSTEM',
        '14574857ytiQYk',
        'defineProp',
        'ogger',
        'PLruU',
        'MXcuF',
        'AUlKT',
        'ngWaE',
        'listCountU',
        'timestamp',
        'TzaBD',
        'omo\x20lida.',
        'senderId',
        ':mensagem-',
        'nsagens\x20co',
        'mHnAA',
        'GCbCq',
        'ZQYeg',
        'all',
        'ensagens\x20n',
        'message',
        'cxEjP',
        'miBmX',
        'NG_MESSAGE',
        '30SCuRkL',
        '\x20erro\x20ao\x20l',
        'uqfLM',
        'NmfzH',
        'mediaType',
        'gcvLW',
        'mPEnV',
        'Ocorreu\x20um',
        'true',
        'user',
        'mo\x20lida.',
        'acao',
        'findByPk',
        '88HUpmwy',
        'indexOf',
        'GaoWD'
    ];
    a = function () {
        return af;
    };
    return a();
}
const criarMensagem = async (n, p) => {
    const a7 = a3, a8 = a2, q = {};
    q[a7(0x111)] = a7(0xc8) + a8(0xdc) + a7(0xfb) + a7(0xf5), q[a7(0xae)] = a8(0xc8) + a7(0x10b) + a7(0x86) + a7(0xb7) + a8(0xcb), q[a7(0x9c)] = a8(0xc8) + a8(0xdc) + a7(0xfd) + a7(0xbc) + a7(0xd1), q[a8(0xb8)] = function (s, t) {
        return s !== t;
    }, q[a7(0x95)] = a7(0x117), q[a8(0x8c)] = a7(0xba), q[a8(0x104)] = function (s, t) {
        return s !== t;
    }, q[a7(0xbf)] = a7(0xa6), q[a8(0xe2)] = a8(0x110), q[a7(0xb9)] = a7(0xa7), q[a7(0xf2)] = a8(0xc4), q[a8(0x93)] = a7(0xde), q[a7(0xf0)] = function (s, t) {
        return s === t;
    }, q[a8(0xc7)] = a8(0xf4), q[a7(0x109)] = a7(0xf1), q[a7(0xa3)] = a7(0x9f) + a7(0xc0) + a7(0xa9), q[a8(0xe1)] = a8(0xc8) + a8(0xc2) + a7(0x91) + a7(0x85), q[a8(0x8f)] = a8(0xe7), q[a8(0xef)] = function (s, t) {
        return s === t;
    }, q[a7(0xa8)] = a8(0xc9), q[a8(0xf8)] = function (s, t) {
        return s !== t;
    }, q[a7(0x80)] = a8(0xb3), q[a7(0xd9)] = a8(0xfc), q[a7(0x94)] = function (s, t) {
        return s > t;
    }, q[a7(0x9d)] = function (s, t) {
        return s !== t;
    }, q[a8(0x11a)] = a7(0xfe), q[a7(0xd7)] = a8(0x123), q[a7(0xb0)] = a7(0xaf), q[a7(0x103)] = a8(0xea), q[a8(0x116)] = a7(0xf6), q[a7(0x100)] = a7(0x127), q[a8(0x12c)] = a7(0x12e);
    const r = q;
    try {
        const {
                text: s,
                timestamp: t,
                receiverId: u,
                isGroup: v
            } = n[a7(0x9a)], {
                id: w,
                tenantId: x
            } = n[a8(0xca)], y = n[a7(0x11c)], z = (-0x1a66 + 0x7e * -0x2 + 0x57a * 0x5, socket_1[a7(0xda)])(), A = {
                'text': s,
                'timestamp': t,
                'receiverId': u,
                'senderId': w,
                'tenantId': x,
                'groupId': null,
                'mediaType': r[a8(0x8f)],
                'mediaUrl': undefined,
                'createdAt': new Date(),
                'updatedAt': new Date()
            };
        if (r[a7(0xef)](v, !![]) || r[a7(0xf0)](v, r[a7(0xa8)])) {
            if (r[a7(0xf8)](r[a8(0x80)], r[a7(0xd9)]))
                A[a8(0x8e)] = undefined, A[a7(0xa2)] = u;
            else {
                E[a8(0xe5)](F);
                const N = {};
                return N[a8(0xe5)] = r[a7(0x111)], H[a7(0x11b)](0x3 * 0x757 + 0x10b * -0x25 + 0x2 * 0x943)[a8(0x10f)](N);
            }
        }
        let B = {};
        if (y && r[a7(0x94)](y[a8(0xa0)], -0x89c * -0x2 + -0x1 * 0x1f29 + 0xdf1)) {
            if (r[a7(0x9d)](r[a7(0x11a)], r[a8(0xd7)]))
                await Promise[a7(0xbb)](y[a8(0xa1)](async N => {
                    const a9 = a7, aa = a7, O = {};
                    O[a9(0xc6)] = r[a9(0x9c)];
                    const P = O;
                    if (r[a9(0xb8)](r[a9(0x95)], r[a9(0x8c)])) {
                        try {
                            if (r[a9(0x104)](r[a9(0xbf)], r[a9(0xe2)])) {
                                if (!N[a9(0xeb)]) {
                                    if (r[a9(0xb8)](r[aa(0xb9)], r[aa(0xb9)]))
                                        D[a9(0xf7)][a9(0xe5)](E);
                                    else {
                                        const T = N[a9(0x7c)][a9(0x105)]('/')[0x6b3 * 0x1 + 0x1bb1 + 0x1 * -0x2263][aa(0x105)](';')[-0x1753 + -0x1 * -0x1321 + 0x432];
                                        N[a9(0xeb)] = new Date()[a9(0x11d)]() + '.' + T;
                                    }
                                }
                            } else
                                F[a9(0x8e)] = H, I[a9(0xa2)] = J;
                        } catch (V) {
                            if (r[aa(0x104)](r[aa(0xf2)], r[aa(0x93)]))
                                logger_1[aa(0xf7)][aa(0xe5)](V);
                            else {
                                const X = E[a9(0x7c)][aa(0x105)]('/')[-0x9fd + -0x1055 + -0x1 * -0x1a53][a9(0x105)](';')[0x205d + -0x1f5b + -0x102];
                                F[aa(0xeb)] = new H()[a9(0x11d)]() + '.' + X;
                            }
                        }
                        const Q = {
                                ...A,
                                'text': N[a9(0x107) + 'me'],
                                'mediaUrl': N[aa(0xeb)],
                                'mediaType': N[aa(0xc5)] || N[aa(0x7c)][a9(0xf9)](-0x4 * -0x4bc + -0x29d * -0x9 + -0x2a75, N[a9(0x7c)][a9(0xcf)]('/'))
                            }, R = await MessageService_1[aa(0x7b)][a9(0xd6) + aa(0x9e)](Q);
                        B = await InternalMessage_1[aa(0x7b)][aa(0xcd)](R['id']);
                        if (!B) {
                            if (r[aa(0xf0)](r[aa(0xc7)], r[aa(0x109)])) {
                                E[aa(0xe5)](F);
                                const Y = {};
                                return Y[a9(0xe5)] = r[aa(0xae)], H[a9(0x11b)](-0x94 * -0x16 + 0x566 * -0x1 + -0x1ca * 0x3)[a9(0x10f)](Y);
                            } else
                                throw new Error(r[aa(0xa3)]);
                        }
                    } else {
                        E[aa(0xe5)](F);
                        const Z = {};
                        return Z[a9(0xe5)] = P[aa(0xc6)], H[a9(0x11b)](0x6 * 0x623 + 0x1 * 0x1fde + -0x42bc)[aa(0x10f)](Z);
                    }
                }));
            else {
                E[a8(0xe5)](F);
                const O = {};
                return O[a8(0xe5)] = r[a7(0xe1)], H[a8(0x11b)](0x1 * -0x907 + 0x1259 + -0x75e)[a7(0x10f)](O);
            }
        } else {
            if (r[a7(0xef)](r[a7(0xb0)], r[a7(0xb0)]))
                B = await MessageService_1[a7(0x7b)][a7(0xd6) + a8(0x9e)](A);
            else {
                if (!F[a8(0xeb)]) {
                    const P = K[a8(0x7c)][a7(0x105)]('/')[0x261 * 0x4 + -0x14cf + 0xb4c][a8(0x105)](';')[0x1b74 + 0x10ee + -0x1a * 0x1b5];
                    L[a8(0xeb)] = new m()[a7(0x11d)]() + '.' + P;
                }
            }
        }
        const C = {};
        C['id'] = B['id'];
        const D = {};
        D[a7(0xdd)] = User_1[a8(0x7b)], D['as'] = r[a7(0x103)], D[a7(0x10e)] = [
            'id',
            r[a8(0x116)]
        ];
        const E = {};
        E[a7(0xdd)] = User_1[a8(0x7b)], E['as'] = r[a8(0x100)], E[a8(0x10e)] = [
            'id',
            r[a8(0x116)]
        ];
        const F = {};
        F[a7(0x126)] = C, F[a7(0x81)] = [
            D,
            E
        ];
        const G = await InternalMessage_1[a7(0x7b)][a8(0x108)](F), H = {};
        H['id'] = G['id'], H[a7(0x8e)] = G[a8(0x8e)], H[a7(0xc5)] = G[a7(0xc5)], H[a8(0xd3)] = G[a7(0xd3)], H[a7(0x8a)] = G[a8(0x8a)], H[a8(0xb5)] = w, H[a8(0xb2)] = G[a7(0xb2)], H[a8(0xea)] = G[a8(0xea)], H[a8(0xa2)] = G[a7(0xa2)], H[a7(0x127)] = G[a8(0x127)], H[a7(0x12d)] = s;
        const I = {};
        I[a7(0xd2)] = r[a8(0x12c)], I[a7(0xe8)] = H, z[a7(0xdf)](x + (a7(0xb6) + a7(0xdb) + 'no'), I);
        const J = {};
        J['id'] = G['id'], J[a7(0x8e)] = u, J[a8(0xb5)] = w, J[a8(0xc5)] = G[a8(0xc5)], J[a8(0xb2)] = G[a8(0xb2)], J[a8(0xea)] = G[a8(0xea)], J[a7(0xa2)] = G[a8(0xa2)], J[a7(0x127)] = G[a8(0x127)], J[a7(0x12d)] = s;
        const K = {};
        K[a7(0xd2)] = r[a7(0x12c)], K[a7(0xe8)] = J, z[a7(0xdf)](x + (a7(0xb6) + a7(0xdb) + a8(0xa4) + a7(0xcc)), K);
        const L = {};
        return L[a8(0xff)] = G, p[a8(0x11b)](0xe25 + -0x2c4 * -0xc + -0x2e8c)[a7(0x10f)](L);
    } catch (P) {
        console[a8(0xe5)](P);
        const Q = {};
        return Q[a7(0xe5)] = r[a7(0x111)], p[a8(0x11b)](-0x11 * -0x44 + 0x7fc + -0x6c * 0x19)[a7(0x10f)](Q);
    }
};
exports[a3(0xd6) + a2(0x9e)] = criarMensagem;
const marcarMensagemNaoLida = async (f, g) => {
    const ab = a2, ac = a3, h = {
            'GaoWD': ab(0x12e),
            'IzQTv': function (i, j) {
                return i(j);
            },
            'bVVqW': ac(0x106) + ab(0xec) + ac(0xb4),
            'uqfLM': ab(0xc8) + ac(0x10b) + ac(0x86) + ab(0xb7) + ab(0xcb)
        };
    try {
        const {contactId: i} = f[ac(0x7d)], {
                id: j,
                tenantId: k
            } = f[ab(0xca)], {isGroup: l} = f[ab(0x9a)], m = (-0x11d * 0x14 + 0x51 + 0x15f3, socket_1[ab(0xda)])(), n = {};
        n[ac(0xf3)] = j, n[ab(0xb5)] = i, n[ab(0x99)] = l, await (-0x2 * 0xc87 + -0x2 * 0x49d + 0x4 * 0x892, ReadMessageService_1[ac(0x7b)])(n), m[ab(0xdf)](k + (ab(0x96) + ab(0xd8) + ac(0x8d)), {
            'action': h[ab(0xd0)],
            'data': {
                'receiverId': j,
                'isGroup': l,
                'senderId': h[ac(0x12b)](Number, i)
            }
        });
        const p = {};
        return p[ab(0xbd)] = h[ab(0x10a)], g[ac(0x11b)](0x1def + -0xedc + -0x1 * 0xe4b)[ac(0x10f)](p);
    } catch (q) {
        console[ac(0xe5)](q);
        const r = {};
        return r[ac(0xe5)] = h[ac(0xc3)], g[ab(0x11b)](-0x38d + -0x1 * 0x1a63 + -0x274 * -0xd)[ac(0x10f)](r);
    }
};
exports[a2(0xd5) + a2(0xe6) + 'a'] = marcarMensagemNaoLida;
const listCountUnreadMessage = async (f, g) => {
    const ad = a2, ae = a3, h = {};
    h[ad(0xbe)] = ae(0xc8) + ae(0xdc) + ad(0xfd) + ad(0xbc) + ae(0xd1);
    const i = h;
    try {
        const {id: j} = f[ae(0xca)], k = await (-0xd1 * 0xa + 0xc99 + -0x46f, ListCountUnreadMessage_1[ad(0x7b)])(j), l = {};
        return l[ad(0x124)] = k, g[ae(0x11b)](-0x1bfa + 0x16a5 + -0x139 * -0x5)[ae(0x10f)](l);
    } catch (m) {
        console[ae(0xe5)](m);
        const n = {};
        return n[ad(0xe5)] = i[ad(0xbe)], g[ae(0x11b)](-0x2 * 0x1319 + 0x1726 + 0x2 * 0x880)[ae(0x10f)](n);
    }
};
exports[a2(0xb1) + a2(0x88) + 'ge'] = listCountUnreadMessage;